import { Question } from "../types";

export const questions: Question[] = [
  // ═══════════════════════════════════════════════════════════════
  //  PROBABILITY
  // ═══════════════════════════════════════════════════════════════
  {
    id: "prob-1",
    category: "probability",
    difficulty: "easy",
    duration: "quick",
    tags: ["expected-value", "interview-classic"],
    title: "Coin Flip Expectation",
    body: "You flip a fair coin 10 times. What is the expected number of heads?",
    choices: ["4", "5", "6", "10"],
    correctIndex: 1,
    explanation:
      "By linearity of expectation, E[heads] = n \u00d7 p = 10 \u00d7 0.5 = 5.",
    hint: "Think about what happens on each individual flip.",
    askedAt: ["citadel", "sig"],
  },
  {
    id: "prob-2",
    category: "probability",
    difficulty: "easy",
    duration: "quick",
    tags: ["combinatorics", "interview-classic"],
    title: "Dice Roll Sum",
    body: "What is the probability of rolling a sum of 7 with two fair dice?",
    choices: ["1/9", "1/6", "5/36", "7/36"],
    correctIndex: 1,
    explanation:
      "There are 6 ways to make 7 out of 36 outcomes: (1,6),(2,5),(3,4),(4,3),(5,2),(6,1). P = 6/36 = 1/6.",
    askedAt: ["optiver", "imc"],
  },
  {
    id: "prob-3",
    category: "probability",
    difficulty: "medium",
    duration: "medium",
    tags: ["combinatorics", "interview-classic"],
    title: "Birthday Problem",
    body: "Minimum number of people for >50% chance that at least two share a birthday?",
    choices: ["23", "50", "57", "183"],
    correctIndex: 0,
    askedAt: ["jane-street", "two-sigma"],
    explanation:
      "With 23 people, P(match) \u2248 50.7%. Uses the complement: P = 1 \u2212 (365/365)(364/365)\u2026(343/365).",
    hint: "Use the complement \u2014 what's the probability that NO two share a birthday?",
    resources: [
      { title: "Birthday Problem explained", url: "https://en.wikipedia.org/wiki/Birthday_problem", type: "article", free: true },
    ],
  },
  {
    id: "prob-4",
    category: "probability",
    difficulty: "medium",
    duration: "medium",
    tags: ["bayesian", "interview-classic"],
    title: "Bayes' Theorem: Disease Test",
    body: "A test has 95% sensitivity and 95% specificity. If 1% of the population has the disease, what\u2019s P(disease | positive test)?",
    choices: ["\u224895%", "\u224850%", "\u224816%", "\u22482%"],
    correctIndex: 2,
    askedAt: ["citadel", "de-shaw", "two-sigma"],
    explanation:
      "P(D|+) = (0.95\u00d70.01)/(0.95\u00d70.01 + 0.05\u00d70.99) = 0.0095/0.059 \u2248 16.1%. Low base rate crushes the PPV.",
    hint: "Apply Bayes' theorem. Don't forget to compute total P(+) using the law of total probability.",
    resources: [
      { title: "3Blue1Brown: Bayes theorem", url: "https://www.youtube.com/watch?v=HZGCoVF3YvM", type: "video", free: true },
    ],
    detailedExplanation:
      "Step 1: Define events. D = has disease, + = positive test. We know P(D) = 0.01, P(+|D) = 0.95 (sensitivity), P(+|no D) = 0.05 (1 - specificity). " +
      "Step 2: Compute total P(+) via law of total probability: P(+) = P(+|D)P(D) + P(+|no D)P(no D) = 0.95 × 0.01 + 0.05 × 0.99 = 0.0095 + 0.0495 = 0.059. " +
      "Step 3: Apply Bayes: P(D|+) = P(+|D)P(D) / P(+) = 0.0095 / 0.059 ≈ 0.161. " +
      "The key insight: even with a 95% accurate test, the low base rate (1%) means most positives are false positives. The 99% of healthy people generating 5% false positives swamp the 1% of sick people generating 95% true positives.",
    commonMistakes: [
      "Confusing sensitivity P(+|D) with positive predictive value P(D|+) — these are very different when the base rate is low",
      "Ignoring the base rate (prior probability) and jumping to '95% accurate means 95% chance of disease'",
      "Forgetting to compute the total P(+) denominator using the law of total probability",
    ],
    guideSection: "prob-bayes",
  },
  {
    id: "prob-5",
    category: "probability",
    difficulty: "hard",
    duration: "medium",
    tags: ["expected-value", "interview-classic"],
    title: "Gambler\u2019s Ruin",
    body: "Fair game: start at $3, win/lose $1 per round. Game ends at $5 or $0. P(ruin)?",
    choices: ["1/5", "2/5", "3/5", "1/2"],
    correctIndex: 1,
    askedAt: ["jane-street", "jump-trading"],
    explanation:
      "In fair gambler\u2019s ruin, P(ruin from k) = 1 \u2212 k/N. Here k=3, N=5, so P = 1 \u2212 3/5 = 2/5.",
    hint: "For a fair game, the ruin probability has a simple formula involving the ratio of starting wealth to target.",
    resources: [
      { title: "Gambler's Ruin", url: "https://en.wikipedia.org/wiki/Gambler%27s_ruin", type: "article", free: true },
    ],
    detailedExplanation:
      "Step 1: Let P(k) = probability of ruin starting with $k, target $N. Set up the recurrence: P(k) = ½P(k+1) + ½P(k-1) for a fair game. " +
      "Step 2: Boundary conditions are P(0) = 1 (already ruined) and P(N) = 0 (reached target). " +
      "Step 3: The general solution to this recurrence for a fair game is P(k) = A + Bk. Applying boundaries: P(0) = 1 gives A = 1; P(N) = 0 gives B = -1/N. " +
      "Step 4: Therefore P(k) = 1 - k/N. With k=3, N=5: P(ruin) = 1 - 3/5 = 2/5. " +
      "Intuition: in a fair game, the martingale property means E[wealth] is constant. The ruin probability is determined purely by the ratio of starting wealth to the total at stake.",
    commonMistakes: [
      "Assuming P(ruin) = 0.5 because the game is fair — fairness of the game does not mean equal ruin/success probability unless you start in the middle",
      "Confusing P(ruin) = 1 - k/N with P(reaching target) = k/N — make sure you know which one the question asks for",
      "Trying to use the biased-game formula (with p ≠ 1/2) when the game is fair — the fair-game formula is a separate limiting case",
    ],
    guideSection: "prob-ev",
  },
  {
    id: "prob-6",
    category: "probability",
    difficulty: "hard",
    duration: "medium",
    tags: ["expected-value", "combinatorics"],
    title: "Coupon Collector",
    body: "Expected draws to collect all 6 types of equally likely coupons?",
    choices: ["6", "10.7", "14.7", "36"],
    correctIndex: 2,
    askedAt: ["jane-street", "hudson-river"],
    explanation:
      "E = 6\u00d7H\u2086 = 6(1 + 1/2 + 1/3 + 1/4 + 1/5 + 1/6) = 6 \u00d7 2.45 = 14.7.",
    hint: "Break into phases: after collecting k types, probability of a new one on next draw is (n\u2212k)/n.",
    detailedExplanation:
      "Step 1: Divide the process into phases. Phase k begins when you have k distinct coupons and ends when you get the (k+1)-th. " +
      "Step 2: In phase k, each draw has probability (n-k)/n of being new. So the number of draws in phase k is Geometric with p = (n-k)/n, giving E[draws in phase k] = n/(n-k). " +
      "Step 3: Total expected draws = \u03a3 from k=0 to n-1 of n/(n-k) = n \u00d7 (1/n + 1/(n-1) + ... + 1/1) = n \u00d7 H\u2099. " +
      "Step 4: For n=6: E = 6 \u00d7 (1 + 1/2 + 1/3 + 1/4 + 1/5 + 1/6) = 6 \u00d7 2.45 = 14.7. " +
      "Key insight: the last coupon alone takes on average n = 6 draws. The difficulty accelerates dramatically near the end.",
    commonMistakes: [
      "Assuming each new coupon takes the same expected number of draws \u2014 the last few coupons take disproportionately long (the 6th type alone takes E[6] draws)",
      "Confusing the coupon collector problem with the birthday problem \u2014 similar setup but different questions (first duplicate vs. complete collection)",
      "Forgetting the harmonic number structure and trying to compute E = n \u00d7 n instead of n \u00d7 H\u2099",
    ],
    guideSection: "prob-ev",
  },
  {
    id: "prob-7",
    category: "probability",
    difficulty: "easy",
    duration: "quick",
    tags: ["distributions", "expected-value"],
    title: "Geometric Distribution",
    body: "You flip a fair coin until you get heads. What is the expected number of flips?",
    choices: ["1", "2", "4", "\u221e"],
    correctIndex: 1,
    explanation:
      "Geometric distribution with p=0.5: E[X] = 1/p = 2 flips on average.",
  },
  {
    id: "prob-8",
    category: "probability",
    difficulty: "medium",
    duration: "quick",
    tags: ["distributions"],
    title: "Poisson Probability",
    body: "A call center gets 2 calls/minute on average (Poisson). P(0 calls in a given minute)?",
    choices: ["e\u207b\u00b2 \u2248 0.135", "0.5", "0.25", "0"],
    correctIndex: 0,
    explanation:
      "Poisson P(X=0) = e^(\u2212\u03bb)\u03bb\u2070/0! = e\u207b\u00b2 \u2248 0.135.",
  },
  {
    id: "prob-9",
    category: "probability",
    difficulty: "hard",
    duration: "long",
    tags: ["martingale", "expected-value"],
    title: "Optional Stopping",
    body: "A symmetric random walk starts at 0. What is E[T] where T = first time the walk hits +1 or \u221210?",
    choices: ["5.5", "10", "11", "\u221e"],
    correctIndex: 1,
    askedAt: ["jane-street", "citadel"],
    explanation:
      "By optional stopping on the martingale X\u00b2\u2212t: E[T] = E[X_T\u00b2] = (10/11)(1) + (1/11)(100) = 10.",
    hint: "Use the martingale W(t)\u00b2 \u2212 t and the optional stopping theorem.",
    resources: [
      { title: "Optional Stopping Theorem", url: "https://en.wikipedia.org/wiki/Optional_stopping_theorem", type: "article", free: true },
    ],
    detailedExplanation:
      "Step 1: We need E[T], not E[X_T]. The trick is to find a martingale involving T. X\u209c (the walk position) is a martingale, but E[X_T] only gives us information about where the walk stops, not when. " +
      "Step 2: M\u209c = X\u209c\u00b2 \u2212 t is also a martingale (verify: E[X\u209c\u00b2|F_s] = X_s\u00b2 + (t\u2212s), so E[X\u209c\u00b2 \u2212 t|F_s] = X_s\u00b2 \u2212 s). " +
      "Step 3: By optional stopping theorem on M\u209c: E[M_T] = M\u2080 = 0, so E[X_T\u00b2] = E[T]. " +
      "Step 4: From the first martingale, E[X_T] = 0 = P(hit +1)(1) + P(hit \u221210)(\u221210). This gives P(hit +1) = 10/11, P(hit \u221210) = 1/11. " +
      "Step 5: E[T] = E[X_T\u00b2] = (10/11)(1) + (1/11)(100) = 10/11 + 100/11 = 110/11 = 10.",
    commonMistakes: [
      "Using the wrong martingale \u2014 X\u209c alone gives E[X_T] = 0 which finds hitting probabilities, but you need X\u209c\u00b2 \u2212 t to extract E[T]",
      "Forgetting to verify the conditions for the optional stopping theorem (T must have finite expectation, or the martingale must be bounded)",
      "Computing E[X_T] when the question asks for E[T] \u2014 these are fundamentally different quantities requiring different martingales",
    ],
    guideSection: "prob-ev",
  },
  {
    id: "prob-10",
    category: "probability",
    difficulty: "medium",
    duration: "quick",
    tags: ["expected-value", "interview-classic"],
    title: "Expected Max of Uniforms",
    body: "Draw 2 numbers independently from Uniform[0,1]. E[max(X,Y)]?",
    choices: ["1/2", "2/3", "3/4", "1"],
    correctIndex: 1,
    explanation:
      "E[max(X\u2081,X\u2082)] = n/(n+1) for n i.i.d. Uniform[0,1]. For n=2: E = 2/3.",
  },
  {
    id: "prob-11",
    category: "probability",
    difficulty: "hard",
    duration: "long",
    tags: ["combinatorics", "interview-classic"],
    title: "Derangements",
    body: "Fraction of permutations of n elements with NO fixed points, as n \u2192 \u221e?",
    choices: ["1/2", "1/e \u2248 0.368", "1 \u2212 1/e \u2248 0.632", "0"],
    correctIndex: 1,
    askedAt: ["two-sigma", "de-shaw"],
    explanation:
      "D(n)/n! \u2192 1/e by inclusion-exclusion. D(n) = n!\u2211(\u22121)^k/k! for k=0..n.",
    hint: "Apply inclusion-exclusion to count permutations with no fixed points. The series looks like e\u207b\u00b9.",
  },

  {
    id: "prob-12",
    category: "probability",
    difficulty: "easy",
    duration: "quick",
    tags: ["expected-value", "interview-classic"],
    askedAt: ["optiver", "imc"],
    title: "Fair Coin Sequences",
    body: "Expected number of fair coin flips to see two consecutive heads?",
    choices: ["4", "6", "8", "10"],
    correctIndex: 1,
    explanation:
      "Let E be the answer. From the start: E = 1 + (1/2)E_H + (1/2)E where E_H = 1 + (1/2)(0) + (1/2)E. Solving: E_H = 1 + E/2, E = 1 + (1/2)(1 + E/2) + E/2 = 1 + 1/2 + E/4 + E/2. So E/4 = 3/2, giving E = 6.",
  },
  {
    id: "prob-13",
    category: "probability",
    difficulty: "medium",
    duration: "medium",
    tags: ["combinatorics", "interview-classic"],
    askedAt: ["jane-street", "sig"],
    title: "Random Walk Return",
    body: "1D symmetric random walk starting at origin. What is P(return to origin)?",
    choices: ["0", "1/2", "1", "Depends on step count"],
    correctIndex: 2,
    explanation:
      "In a 1D symmetric random walk, P(return to origin) = 1. The walk is recurrent in 1D and 2D, but transient in 3D+.",
  },
  {
    id: "prob-14",
    category: "probability",
    difficulty: "hard",
    duration: "long",
    tags: ["expected-value", "combinatorics"],
    askedAt: ["jane-street", "two-sigma"],
    title: "Coupon Collector Variance",
    body: "For the coupon collector problem with n types, what is Var(T)?",
    choices: ["n\u00b2 \u03c0\u00b2/6", "n(n-1)", "n\u00b2 \u2211 1/k\u00b2 (k=1..n)", "n\u00b2 (H_n)\u00b2"],
    correctIndex: 0,
    explanation:
      "Var(T) = \u2211 n\u00b2 \u00d7 (1-p_k)/p_k\u00b2 where p_k = (n-k+1)/n. This simplifies to n\u00b2 \u2211 1/k\u00b2 from k=1 to n. As n\u2192\u221e, this approaches n\u00b2\u03c0\u00b2/6.",
  },
  {
    id: "prob-15",
    category: "probability",
    difficulty: "easy",
    duration: "quick",
    tags: ["distributions", "interview-classic"],
    title: "Memoryless Property",
    body: "Which continuous distribution has the memoryless property?",
    choices: ["Normal", "Uniform", "Exponential", "Gamma"],
    correctIndex: 2,
    explanation:
      "The exponential distribution is the only continuous memoryless distribution: P(X > s+t | X > s) = P(X > t).",
  },
  {
    id: "prob-16",
    category: "probability",
    difficulty: "medium",
    duration: "medium",
    tags: ["expected-value", "interview-classic"],
    askedAt: ["citadel", "jump-trading"],
    title: "Expected Tosses for Pattern",
    body: "You toss a fair coin repeatedly. What is E[tosses] to first see the pattern HT?",
    choices: ["2", "4", "6", "8"],
    correctIndex: 1,
    explanation:
      "E[HT] = 4. Using Markov chain states: Start, H, HT(done). From Start: E = 1 + (1/2)E_H + (1/2)E. From H: E_H = 1 + (1/2)E_H + (1/2)(0). Solving: E_H = 2, E = 1 + 1 + E/2, so E = 4.",
  },
  {
    id: "prob-17",
    category: "probability",
    difficulty: "hard",
    duration: "long",
    tags: ["bayesian", "interview-classic"],
    askedAt: ["jane-street"],
    title: "Conditional Independence Trap",
    body: "X, Y are conditionally independent given Z. Does this imply X, Y are (unconditionally) independent?",
    choices: ["Yes, always", "No, never", "No, not in general", "Only if Z is binary"],
    correctIndex: 2,
    explanation:
      "Conditional independence does NOT imply marginal independence. Classic counterexample: Z = coin choice (fair vs biased), X = flip 1, Y = flip 2. Given Z, flips are independent. But marginally, X and Y are positively correlated.",
  },
  {
    id: "prob-18",
    category: "probability",
    difficulty: "medium",
    duration: "medium",
    tags: ["expected-value"],
    askedAt: ["hudson-river", "optiver"],
    title: "Max of n Dice",
    body: "Roll two fair dice. What is E[max(die1, die2)]?",
    choices: ["3.5", "4.47", "4.72", "5.0"],
    correctIndex: 1,
    explanation:
      "E[max] = \u2211 k \u00d7 P(max=k). P(max=k) = (k\u00b2 - (k-1)\u00b2)/36 = (2k-1)/36. E = \u2211 k(2k-1)/36 for k=1..6 = (1+6+15+28+45+66)/36 = 161/36 \u2248 4.47.",
  },
  {
    id: "prob-19",
    category: "probability",
    difficulty: "hard",
    duration: "long",
    tags: ["expected-value", "interview-classic"],
    askedAt: ["jane-street", "citadel"],
    title: "Random Walk Hitting Time",
    body: "Symmetric random walk on integers. Starting at 0, what is E[time to reach +n or -n]?",
    choices: ["n", "n\u00b2", "2n", "n\u00b2/2"],
    correctIndex: 1,
    explanation:
      "By the optional stopping theorem on the martingale X\u209c\u00b2 - t: E[T] = E[X_T\u00b2] = n\u00b2 (by symmetry, the walk hits +n or -n with equal probability, and X_T\u00b2 = n\u00b2 in both cases).",
  },
  {
    id: "prob-20",
    category: "probability",
    difficulty: "easy",
    duration: "quick",
    tags: ["combinatorics"],
    title: "Cards Without Replacement",
    body: "Draw 2 cards from a standard 52-card deck without replacement. P(both are aces)?",
    choices: ["1/169", "1/221", "1/256", "1/13"],
    correctIndex: 1,
    explanation:
      "P = (4/52) \u00d7 (3/51) = 12/2652 = 1/221. Without replacement, the second draw has only 3 aces left among 51 cards.",
  },
  {
    id: "prob-21",
    category: "probability",
    difficulty: "medium",
    duration: "quick",
    tags: ["distributions", "expected-value"],
    askedAt: ["sig", "imc"],
    title: "Sum of Poisson",
    body: "X ~ Poisson(3), Y ~ Poisson(5), independent. What is the distribution of X + Y?",
    choices: ["Poisson(8)", "Poisson(15)", "Normal(8, 8)", "Binomial(8, 0.5)"],
    correctIndex: 0,
    explanation:
      "The sum of independent Poisson random variables is Poisson with parameter equal to the sum: X + Y ~ Poisson(3 + 5) = Poisson(8).",
  },

  // ═══════════════════════════════════════════════════════════════
  //  STATISTICS
  // ═══════════════════════════════════════════════════════════════
  {
    id: "stat-1",
    category: "statistics",
    difficulty: "easy",
    duration: "quick",
    tags: ["distributions"],
    title: "Central Limit Theorem",
    body: "The CLT says the sampling distribution of the sample mean approaches which distribution?",
    choices: ["Uniform", "Poisson", "Normal", "Exponential"],
    correctIndex: 2,
    explanation:
      "Regardless of the population distribution, sample means \u2192 Normal as n \u2192 \u221e.",
  },
  {
    id: "stat-2",
    category: "statistics",
    difficulty: "easy",
    duration: "quick",
    tags: ["variance"],
    title: "Variance of Sum",
    body: "X and Y independent with Var(X)=4, Var(Y)=9. What is Var(X+Y)?",
    choices: ["5", "13", "6", "36"],
    correctIndex: 1,
    explanation:
      "For independent RVs: Var(X+Y) = Var(X) + Var(Y) = 4 + 9 = 13.",
  },
  {
    id: "stat-3",
    category: "statistics",
    difficulty: "medium",
    duration: "quick",
    tags: ["regression"],
    title: "Correlation Coefficient",
    body: "Cov(X,Y) = 6, SD(X) = 3, SD(Y) = 4. What is \u03c1(X,Y)?",
    choices: ["0.25", "0.5", "0.75", "2"],
    correctIndex: 1,
    explanation: "\u03c1 = Cov(X,Y)/(SD(X)\u00d7SD(Y)) = 6/(3\u00d74) = 0.5.",
  },
  {
    id: "stat-4",
    category: "statistics",
    difficulty: "medium",
    duration: "medium",
    tags: ["distributions"],
    title: "MLE for Exponential",
    body: "For n observations from Exp(\u03bb), the MLE of \u03bb is:",
    choices: ["n / \u2211x\u1d62", "\u2211x\u1d62 / n", "max(x\u1d62)", "min(x\u1d62)"],
    correctIndex: 0,
    askedAt: ["two-sigma", "de-shaw"],
    explanation:
      "Log-likelihood: l(\u03bb) = n\u00b7ln(\u03bb) \u2212 \u03bb\u2211x\u1d62. Setting dl/d\u03bb = 0 gives \u03bb\u0302 = n/\u2211x\u1d62.",
    hint: "Write the likelihood, take the log, differentiate, and set to 0.",
    detailedExplanation:
      "Step 1: Write the likelihood. For n i.i.d. observations from Exp(\u03bb), L(\u03bb) = \u220f \u03bb e^(\u2212\u03bbx\u1d62) = \u03bb\u207f e^(\u2212\u03bb\u2211x\u1d62). " +
      "Step 2: Take the log-likelihood: l(\u03bb) = n\u00b7ln(\u03bb) \u2212 \u03bb\u2211x\u1d62. " +
      "Step 3: Differentiate with respect to \u03bb: dl/d\u03bb = n/\u03bb \u2212 \u2211x\u1d62. " +
      "Step 4: Set to zero: n/\u03bb = \u2211x\u1d62, so \u03bb\u0302 = n/\u2211x\u1d62 = 1/x\u0304 (reciprocal of sample mean). " +
      "Step 5: Verify it is a maximum: d\u00b2l/d\u03bb\u00b2 = \u2212n/\u03bb\u00b2 < 0. Confirmed maximum. " +
      "Key insight: the MLE of the rate \u03bb is the reciprocal of the sample mean, NOT the sample mean itself.",
    commonMistakes: [
      "Confusing the MLE of \u03bb (rate) with the MLE of 1/\u03bb (mean) \u2014 the MLE of \u03bb is n/\u2211x\u1d62, while \u2211x\u1d62/n estimates the mean",
      "Forgetting to verify the second derivative is negative to confirm a maximum (not a minimum or saddle point)",
      "Using the wrong parameterization \u2014 some textbooks write Exp(\u03bb) with f(x) = \u03bbe^(\u2212\u03bbx) and others use f(x) = (1/\u03b8)e^(\u2212x/\u03b8)",
    ],
    guideSection: "stat-mle",
  },
  {
    id: "stat-5",
    category: "statistics",
    difficulty: "hard",
    duration: "long",
    tags: ["variance", "expected-value"],
    title: "Law of Total Variance",
    body: "Var(Y) = E[Var(Y|X)] + Var(E[Y|X]). If E[Y|X]=2X, Var(Y|X)=3, E[X]=1, Var(X)=2. Var(Y)?",
    choices: ["7", "8", "11", "14"],
    correctIndex: 2,
    explanation:
      "E[Var(Y|X)] = 3. Var(E[Y|X]) = Var(2X) = 4\u00b7Var(X) = 8. Var(Y) = 3 + 8 = 11.",
    hint: "Apply the law of total variance: Var(Y) = E[Var(Y|X)] + Var(E[Y|X]).",
    resources: [
      { title: "Law of Total Variance", url: "https://en.wikipedia.org/wiki/Law_of_total_variance", type: "article", free: true },
    ],
    detailedExplanation:
      "Step 1: Recall the law of total variance: Var(Y) = E[Var(Y|X)] + Var(E[Y|X]). The first term captures 'average within-group variance' and the second captures 'between-group variance'. " +
      "Step 2: Compute E[Var(Y|X)]. We are told Var(Y|X) = 3 (constant, does not depend on X). So E[Var(Y|X)] = E[3] = 3. " +
      "Step 3: Compute Var(E[Y|X]). We are told E[Y|X] = 2X. So Var(E[Y|X]) = Var(2X) = 4\u00b7Var(X) = 4 \u00d7 2 = 8. " +
      "Step 4: Combine: Var(Y) = 3 + 8 = 11. " +
      "Key insight: even though the conditional variance of Y given X is small (3), the variation in the conditional mean (E[Y|X] = 2X) adds substantial variance (8) because X itself varies.",
    commonMistakes: [
      "Swapping the two terms \u2014 confusing E[Var(Y|X)] (average within-group spread) with Var(E[Y|X]) (spread of group means)",
      "Forgetting to apply the scaling property Var(aX) = a\u00b2Var(X) when computing Var(2X) = 4\u00b7Var(X), not 2\u00b7Var(X)",
      "Only computing one of the two terms and thinking it equals the full Var(Y)",
    ],
    guideSection: "stat-regression",
  },
  {
    id: "stat-6",
    category: "statistics",
    difficulty: "easy",
    duration: "quick",
    tags: ["distributions"],
    title: "68-95-99.7 Rule",
    body: "What % of data falls within 2\u03c3 of the mean in a normal distribution?",
    choices: ["68%", "90%", "95%", "99.7%"],
    correctIndex: 2,
    explanation: "~68% within 1\u03c3, ~95% within 2\u03c3, ~99.7% within 3\u03c3.",
  },
  {
    id: "stat-7",
    category: "statistics",
    difficulty: "medium",
    duration: "medium",
    tags: ["regression"],
    title: "R\u00b2 Interpretation",
    body: "Linear regression: R\u00b2 = 0.81 and \u03c1(X,Y) > 0. What is \u03c1(X,Y)?",
    choices: ["0.81", "0.9", "0.656", "0.405"],
    correctIndex: 1,
    explanation: "R\u00b2 = \u03c1\u00b2 in simple regression. \u03c1 = \u221a0.81 = 0.9.",
  },
  {
    id: "stat-8",
    category: "statistics",
    difficulty: "hard",
    duration: "medium",
    tags: ["time-series"],
    title: "AR(1) Stationarity",
    body: "AR(1): X\u209c = \u03d5X\u209c\u208b\u2081 + \u03b5\u209c is stationary when:",
    choices: ["\u03d5 > 0", "|\u03d5| < 1", "\u03d5 < 1", "|\u03d5| = 1"],
    correctIndex: 1,
    askedAt: ["citadel", "hudson-river"],
    explanation:
      "Stationarity requires |\u03d5| < 1. At |\u03d5|=1 we get a random walk (unit root).",
    hint: "Think about what happens to the variance of X\u209c as t grows. When does it diverge?",
  },
  {
    id: "stat-9",
    category: "statistics",
    difficulty: "medium",
    duration: "quick",
    tags: ["bayesian"],
    title: "Conjugate Prior",
    body: "The conjugate prior for a Bernoulli likelihood is:",
    choices: ["Normal", "Beta", "Gamma", "Poisson"],
    correctIndex: 1,
    explanation:
      "Beta is conjugate for Bernoulli/Binomial. Posterior stays Beta.",
  },
  {
    id: "stat-10",
    category: "statistics",
    difficulty: "hard",
    duration: "long",
    tags: ["time-series", "variance"],
    title: "GARCH(1,1) Persistence",
    body: "GARCH(1,1): \u03c3\u00b2\u209c = \u03c9 + \u03b1\u03b5\u00b2\u209c\u208b\u2081 + \u03b2\u03c3\u00b2\u209c\u208b\u2081. Unconditional variance exists when:",
    choices: ["\u03b1 + \u03b2 < 1", "\u03b1 + \u03b2 = 1", "\u03b1 < 1", "\u03b2 < 1"],
    correctIndex: 0,
    askedAt: ["de-shaw", "two-sigma"],
    explanation:
      "Unconditional variance = \u03c9/(1\u2212\u03b1\u2212\u03b2), exists only when \u03b1+\u03b2 < 1.",
    hint: "Assume stationarity and take expectations on both sides of the GARCH equation.",
    resources: [
      { title: "GARCH Models (QuantStart)", url: "https://www.quantstart.com/articles/Generalised-Autoregressive-Conditional-Heteroskedasticity-GARCH-p-q-Models-for-Time-Series-Analysis/", type: "article", free: true },
    ],
    detailedExplanation:
      "Step 1: Start with GARCH(1,1): \u03c3\u00b2\u209c = \u03c9 + \u03b1\u03b5\u00b2\u209c\u208b\u2081 + \u03b2\u03c3\u00b2\u209c\u208b\u2081. For stationarity, we need the unconditional variance \u03c3\u00b2 = E[\u03c3\u00b2\u209c] to be constant and finite. " +
      "Step 2: Take unconditional expectations on both sides: \u03c3\u00b2 = \u03c9 + \u03b1\u03c3\u00b2 + \u03b2\u03c3\u00b2 (since E[\u03b5\u00b2\u209c\u208b\u2081] = \u03c3\u00b2 and E[\u03c3\u00b2\u209c\u208b\u2081] = \u03c3\u00b2 under stationarity). " +
      "Step 3: Rearrange: \u03c3\u00b2(1 \u2212 \u03b1 \u2212 \u03b2) = \u03c9, so \u03c3\u00b2 = \u03c9/(1 \u2212 \u03b1 \u2212 \u03b2). " +
      "Step 4: For this to be positive and finite, we need 1 \u2212 \u03b1 \u2212 \u03b2 > 0, i.e., \u03b1 + \u03b2 < 1. " +
      "The quantity \u03b1 + \u03b2 measures volatility persistence. When \u03b1 + \u03b2 = 1 (IGARCH), shocks persist forever and no finite unconditional variance exists.",
    commonMistakes: [
      "Confusing GARCH stationarity condition (\u03b1+\u03b2 < 1) with AR(1) stationarity (|\u03c6| < 1) \u2014 they have different structures",
      "Forgetting that \u03b1+\u03b2 = 1 is the IGARCH (integrated) case where the unconditional variance is infinite, not just the boundary",
      "Mixing up the roles of \u03b1 (ARCH: impact of recent shocks) and \u03b2 (GARCH: persistence of past variance) when interpreting the model",
    ],
    guideSection: "stat-timeseries",
  },

  {
    id: "stat-11",
    category: "statistics",
    difficulty: "easy",
    duration: "quick",
    tags: ["regression"],
    askedAt: ["citadel", "two-sigma"],
    title: "Multicollinearity Effect",
    body: "High multicollinearity among regressors primarily causes:",
    choices: ["Biased coefficients", "Large standard errors on coefficients", "Omitted variable bias", "Heteroscedasticity"],
    correctIndex: 1,
    explanation:
      "Multicollinearity inflates the variance of OLS estimates (large standard errors) but does NOT bias them. Coefficients remain unbiased but become unreliable.",
  },
  {
    id: "stat-12",
    category: "statistics",
    difficulty: "medium",
    duration: "medium",
    tags: ["regression"],
    askedAt: ["de-shaw"],
    title: "Heteroscedasticity Consequence",
    body: "Under heteroscedasticity, OLS estimates are:",
    choices: ["Biased and inefficient", "Unbiased but inefficient", "Biased but efficient", "Unbiased and efficient"],
    correctIndex: 1,
    explanation:
      "OLS remains unbiased under heteroscedasticity (Gauss-Markov does not require homoscedasticity for unbiasedness). However, OLS is no longer BLUE (best linear unbiased) -- it is inefficient and standard errors are wrong.",
  },
  {
    id: "stat-13",
    category: "statistics",
    difficulty: "hard",
    duration: "long",
    tags: ["distributions", "variance"],
    askedAt: ["two-sigma", "hudson-river"],
    title: "Bootstrap Principle",
    body: "The bootstrap estimates the sampling distribution of a statistic by:",
    choices: [
      "Assuming normality and using analytical formulas",
      "Resampling with replacement from the observed data",
      "Resampling without replacement from the observed data",
      "Simulating from a fitted parametric model",
    ],
    correctIndex: 1,
    explanation:
      "The nonparametric bootstrap resamples WITH replacement from the observed data, treating the empirical distribution as a proxy for the true population. Each resample has size n (same as original).",
  },
  {
    id: "stat-14",
    category: "statistics",
    difficulty: "medium",
    duration: "medium",
    tags: ["distributions"],
    title: "Chi-Squared DOF",
    body: "If Z_1, ..., Z_n are i.i.d. N(0,1), then \u2211Z_i\u00b2 follows:",
    choices: ["N(0, n)", "\u03c7\u00b2(n)", "\u03c7\u00b2(n-1)", "F(n, n)"],
    correctIndex: 1,
    explanation:
      "The sum of squares of n independent standard normals follows a chi-squared distribution with n degrees of freedom: \u2211Z_i\u00b2 ~ \u03c7\u00b2(n).",
  },
  {
    id: "stat-15",
    category: "statistics",
    difficulty: "easy",
    duration: "quick",
    tags: ["regression"],
    askedAt: ["sig"],
    title: "Type I Error",
    body: "In hypothesis testing, a Type I error is:",
    choices: [
      "Failing to reject a false null",
      "Rejecting a true null",
      "Accepting the alternative when it is false",
      "Failing to collect enough data",
    ],
    correctIndex: 1,
    explanation:
      "Type I error = rejecting H\u2080 when H\u2080 is actually true (false positive). The significance level \u03b1 controls the Type I error rate.",
  },
  {
    id: "stat-16",
    category: "statistics",
    difficulty: "hard",
    duration: "medium",
    tags: ["time-series", "regression"],
    askedAt: ["de-shaw", "citadel"],
    title: "Spurious Regression",
    body: "Regressing one random walk on another independent random walk typically yields:",
    choices: ["R\u00b2 near 0", "Statistically significant R\u00b2", "Negative R\u00b2", "Undefined R\u00b2"],
    correctIndex: 1,
    explanation:
      "Spurious regression: two independent unit root processes often show high R\u00b2 and significant t-stats. The Granger-Newbold problem. Test for cointegration or use differenced data.",
  },
  {
    id: "stat-17",
    category: "statistics",
    difficulty: "medium",
    duration: "quick",
    tags: ["bayesian"],
    askedAt: ["jump-trading"],
    title: "Prior Predictive",
    body: "In Bayesian statistics, the marginal likelihood P(data) is also called the:",
    choices: ["Posterior", "Likelihood", "Evidence (model evidence)", "Prior predictive"],
    correctIndex: 2,
    explanation:
      "P(data) = \u222bP(data|\u03b8)P(\u03b8)d\u03b8 is called the model evidence or marginal likelihood. It is used for Bayesian model comparison via Bayes factors.",
  },
  {
    id: "stat-18",
    category: "statistics",
    difficulty: "hard",
    duration: "long",
    tags: ["regression", "variance"],
    askedAt: ["two-sigma"],
    title: "James-Stein Estimator",
    body: "The James-Stein estimator dominates the MLE for estimating n\u22653 normal means by:",
    choices: [
      "Increasing bias to reduce variance (shrinkage)",
      "Using a different likelihood function",
      "Removing outliers",
      "Using Bayesian priors only",
    ],
    correctIndex: 0,
    explanation:
      "James-Stein shrinks individual estimates toward the grand mean, trading increased bias for decreased variance. For n\u22653 means, total MSE is strictly lower than the MLE. This is the Stein paradox.",
  },

  // ═══════════════════════════════════════════════════════════════
  //  STOCHASTIC CALCULUS
  // ═══════════════════════════════════════════════════════════════
  {
    id: "stoch-1",
    category: "stochastic-calculus",
    difficulty: "easy",
    duration: "quick",
    tags: ["martingale"],
    title: "Brownian Motion Property",
    body: "Which property does standard Brownian motion W(t) NOT have?",
    choices: [
      "W(0) = 0",
      "Independent increments",
      "Continuous paths",
      "Stationary distribution",
    ],
    correctIndex: 3,
    explanation:
      "W(t) ~ N(0,t) \u2014 variance grows with t, so there\u2019s no stationary distribution.",
  },
  {
    id: "stoch-2",
    category: "stochastic-calculus",
    difficulty: "medium",
    duration: "medium",
    tags: ["ito-calculus", "interview-classic", "derivation"],
    title: "It\u00f4\u2019s Lemma: d(ln S)",
    askedAt: ["jane-street", "citadel", "two-sigma"],
    body: "If dS = \u03bcS dt + \u03c3S dW, what is d(ln S)?",
    choices: [
      "(\u03bc \u2212 \u03c3\u00b2/2) dt + \u03c3 dW",
      "\u03bc dt + \u03c3 dW",
      "(\u03bc + \u03c3\u00b2/2) dt + \u03c3 dW",
      "(\u03bc \u2212 \u03c3\u00b2) dt + \u03c3 dW",
    ],
    correctIndex: 0,
    explanation:
      "It\u00f4\u2019s lemma on f(S)=ln(S): df = (1/S)dS \u2212 \u00bd(1/S\u00b2)(\u03c3S)\u00b2dt = (\u03bc \u2212 \u03c3\u00b2/2)dt + \u03c3dW.",
    hint: "Apply It\u00f4's lemma to f(S) = ln(S). Remember the extra \u00bd f''(dS)\u00b2 term.",
    resources: [
      { title: "It\u00f4's Lemma (QuantStart)", url: "https://www.quantstart.com/articles/Itos-Lemma/", type: "article", free: true },
    ],
    detailedExplanation:
      "Step 1: It\u00f4\u2019s lemma states that for f(S): df = f\u2032(S)dS + \u00bdf\u2033(S)(dS)\u00b2. The key difference from ordinary calculus is the (dS)\u00b2 term. " +
      "Step 2: For f(S) = ln(S): f\u2032(S) = 1/S and f\u2033(S) = \u22121/S\u00b2. " +
      "Step 3: Compute (dS)\u00b2. Since dS = \u03bcS dt + \u03c3S dW, we get (dS)\u00b2 = \u03c3\u00b2S\u00b2 dt (using the rules: (dW)\u00b2 = dt, dt\u00b7dW = 0, (dt)\u00b2 = 0). " +
      "Step 4: Substitute: d(ln S) = (1/S)(\u03bcS dt + \u03c3S dW) + \u00bd(\u22121/S\u00b2)(\u03c3\u00b2S\u00b2 dt) = \u03bc dt + \u03c3 dW \u2212 \u03c3\u00b2/2 dt = (\u03bc \u2212 \u03c3\u00b2/2) dt + \u03c3 dW. " +
      "This is why GBM gives log-returns that are normally distributed with drift \u03bc \u2212 \u03c3\u00b2/2, NOT \u03bc. The \u2212\u03c3\u00b2/2 is the It\u00f4 correction, arising purely from the quadratic variation of Brownian motion.",
    commonMistakes: [
      "Forgetting the \u2212\u03c3\u00b2/2 correction term \u2014 applying ordinary calculus (d(ln S) = dS/S) instead of It\u00f4 calculus gives (\u03bc)dt + \u03c3dW, which is wrong",
      "Getting the sign wrong on the \u03c3\u00b2/2 term \u2014 it is MINUS \u03c3\u00b2/2 because f\u2033(S) = \u22121/S\u00b2 is negative",
      "Not recognizing that (dW)\u00b2 = dt is the fundamental rule of It\u00f4 calculus that makes stochastic calculus different from ordinary calculus",
    ],
    guideSection: "stoch-ito",
  },
  {
    id: "stoch-3",
    category: "stochastic-calculus",
    difficulty: "medium",
    duration: "quick",
    tags: ["ito-calculus"],
    title: "Quadratic Variation",
    body: "What is [W,W](t) of standard BM over [0,t]?",
    choices: ["0", "t", "t\u00b2", "\u221at"],
    correctIndex: 1,
    explanation:
      "[W,W](t) = t because (dW)\u00b2 = dt in It\u00f4 calculus.",
  },
  {
    id: "stoch-4",
    category: "stochastic-calculus",
    difficulty: "hard",
    duration: "medium",
    tags: ["martingale", "risk-management"],
    title: "Girsanov\u2019s Theorem",
    askedAt: ["citadel", "de-shaw"],
    body: "Changing from P to risk-neutral Q measure via Girsanov is used to:",
    choices: [
      "Eliminate volatility",
      "Make all assets earn r in expectation",
      "Remove randomness",
      "Increase Sharpe ratio",
    ],
    correctIndex: 1,
    explanation:
      "Under Q, discounted assets are martingales \u2014 all earn the risk-free rate in expectation.",
    hint: "Girsanov changes the drift. What must the drift become for risk-neutral pricing?",
    resources: [
      { title: "Girsanov's Theorem", url: "https://en.wikipedia.org/wiki/Girsanov_theorem", type: "article", free: true },
    ],
    detailedExplanation:
      "Step 1: Under the physical measure P, a stock follows dS = \u03bcS dt + \u03c3S dW_P. Different investors may disagree on \u03bc, so pricing options using \u03bc would give different prices. " +
      "Step 2: Girsanov\u2019s theorem says we can change to a new measure Q by defining dW_Q = dW_P + \u03b8 dt, where \u03b8 = (\u03bc \u2212 r)/\u03c3 is the market price of risk. " +
      "Step 3: Under Q, the stock dynamics become dS = rS dt + \u03c3S dW_Q. The drift changes from \u03bc to r, but crucially the volatility \u03c3 stays the same. " +
      "Step 4: Under Q, discounted asset prices e^(\u2212rt)S\u209c are martingales. This means we can price any derivative as V = e^(\u2212rT) E^Q[payoff]. " +
      "The deep insight: Girsanov eliminates the need to estimate \u03bc (which is extremely hard statistically). Option prices depend only on \u03c3, r, and the payoff structure.",
    commonMistakes: [
      "Thinking Girsanov changes the volatility \u2014 it only changes the drift from \u03bc to r; the diffusion coefficient \u03c3 remains identical",
      "Confusing the physical measure P (real-world probabilities) with the risk-neutral measure Q (pricing probabilities) \u2014 Q is not the 'true' probability",
      "Forgetting the Novikov condition (E[exp(\u00bd\u222b\u03b8\u00b2 dt)] < \u221e) needed for Girsanov\u2019s theorem to be valid",
    ],
    guideSection: "stoch-girsanov",
  },
  {
    id: "stoch-5",
    category: "stochastic-calculus",
    difficulty: "hard",
    duration: "long",
    tags: ["mean-reversion", "derivation"],
    title: "OU Process Variance",
    askedAt: ["jump-trading", "hudson-river"],
    body: "dX = \u03b8(\u03bc \u2212 X)dt + \u03c3dW. Long-run variance as t \u2192 \u221e?",
    choices: ["\u03c3\u00b2/(2\u03b8)", "\u03c3\u00b2/\u03b8", "\u03c3\u00b2\u03b8/2", "\u03c3\u00b2"],
    correctIndex: 0,
    explanation:
      "OU stationary variance = \u03c3\u00b2/(2\u03b8). Higher \u03b8 = faster reversion = less variance.",
    hint: "Solve for the steady-state variance by setting dVar/dt = 0.",
    resources: [
      { title: "Ornstein-Uhlenbeck Process", url: "https://en.wikipedia.org/wiki/Ornstein%E2%80%93Uhlenbeck_process", type: "article", free: true },
    ],
    detailedExplanation:
      "Step 1: The OU process dX = \u03b8(\u03bc \u2212 X)dt + \u03c3dW has solution X(t) = \u03bc + (X\u2080 \u2212 \u03bc)e^(\u2212\u03b8t) + \u03c3\u222b\u2080\u1d57 e^(\u2212\u03b8(t\u2212s)) dW(s). " +
      "Step 2: The variance of X(t) comes from the stochastic integral: Var(X(t)) = \u03c3\u00b2 \u222b\u2080\u1d57 e^(\u22122\u03b8(t\u2212s)) ds = \u03c3\u00b2/(2\u03b8) \u00d7 (1 \u2212 e^(\u22122\u03b8t)). " +
      "Step 3: As t \u2192 \u221e, e^(\u22122\u03b8t) \u2192 0 (since \u03b8 > 0), so Var(X(\u221e)) = \u03c3\u00b2/(2\u03b8). " +
      "Step 4: Intuition check: higher \u03b8 means faster mean reversion, pulling X back toward \u03bc more quickly, so variance should be smaller. Indeed \u03c3\u00b2/(2\u03b8) decreases with \u03b8. Similarly, higher \u03c3 means more random kicks, so variance grows with \u03c3\u00b2. " +
      "This is a key result for pairs trading: the stationary variance determines the natural bandwidth around the mean.",
    commonMistakes: [
      "Forgetting the factor of 2 in the denominator \u2014 writing \u03c3\u00b2/\u03b8 instead of \u03c3\u00b2/(2\u03b8) is the most common error",
      "Confusing the OU process with a random walk plus drift \u2014 the OU process is mean-reverting (stationary) while a random walk has variance growing linearly in time",
      "Not recognizing that \u03b8 must be positive for the process to be stationary \u2014 if \u03b8 \u2264 0 the process is explosive or non-stationary",
    ],
    guideSection: "stoch-sde",
  },
  {
    id: "stoch-6",
    category: "stochastic-calculus",
    difficulty: "easy",
    duration: "quick",
    tags: ["distributions"],
    title: "Brownian Increment",
    body: "W is standard BM. What is the distribution of W(3) \u2212 W(1)?",
    choices: ["N(0, 2)", "N(0, 3)", "N(0, 4)", "N(2, 1)"],
    correctIndex: 0,
    explanation:
      "W(t)\u2212W(s) ~ N(0, t\u2212s). So W(3)\u2212W(1) ~ N(0, 2).",
  },
  {
    id: "stoch-7",
    category: "stochastic-calculus",
    difficulty: "medium",
    duration: "medium",
    tags: ["ito-calculus", "derivation"],
    title: "It\u00f4 Isometry",
    body: "For deterministic f(t), E[(\u222b\u2080\u1d40 f(t)dW)\u00b2] equals:",
    choices: [
      "(\u222b\u2080\u1d40 f(t)dt)\u00b2",
      "\u222b\u2080\u1d40 f(t)\u00b2 dt",
      "\u222b\u2080\u1d40 |f(t)| dt",
      "T \u00d7 E[f\u00b2]",
    ],
    correctIndex: 1,
    explanation:
      "It\u00f4 isometry: E[(\u222bf dW)\u00b2] = \u222bf\u00b2 dt. Square goes inside, dW \u2192 dt.",
  },
  {
    id: "stoch-8",
    category: "stochastic-calculus",
    difficulty: "hard",
    duration: "long",
    tags: ["pde", "black-scholes", "derivation"],
    title: "Feynman-Kac",
    body: "Feynman-Kac theorem links which two objects?",
    choices: [
      "SDEs and linear algebra",
      "PDEs and expectations of diffusions",
      "Martingales and Markov chains",
      "Fourier transforms and option prices",
    ],
    correctIndex: 1,
    explanation:
      "Feynman-Kac connects PDEs to conditional expectations of stochastic processes \u2014 the backbone of derivatives pricing.",
    hint: "Think about the BS PDE and how its solution relates to E^Q[payoff].",
    resources: [
      { title: "Feynman-Kac Formula", url: "https://en.wikipedia.org/wiki/Feynman%E2%80%93Kac_formula", type: "article", free: true },
    ],
    detailedExplanation:
      "Step 1: Consider a PDE of the form \u2202u/\u2202t + b(x)\u2202u/\u2202x + \u00bd\u03c3\u00b2(x)\u2202\u00b2u/\u2202x\u00b2 \u2212 r(x)u = 0 with terminal condition u(T,x) = g(x). " +
      "Step 2: Feynman-Kac says the solution is u(t,x) = E[e^(\u2212\u222b r(X_s) ds) g(X_T) | X_t = x], where dX = b(X)dt + \u03c3(X)dW. " +
      "Step 3: This is exactly the Black-Scholes framework: the BS PDE has r(x) = r (constant), b(x) = rx, \u03c3(x) = \u03c3x. The terminal condition g(S_T) = max(S_T \u2212 K, 0) for a call. " +
      "Step 4: So the BS price is V(t,S) = e^(\u2212r(T\u2212t)) E^Q[payoff | S_t = S]. Feynman-Kac tells us that solving the PDE and computing the expectation are equivalent. " +
      "This duality is the backbone of derivatives pricing: you can either solve the PDE numerically (finite differences) or compute the expectation (Monte Carlo/analytical). Both give the same answer.",
    commonMistakes: [
      "Not recognizing that the Black-Scholes PDE is a specific instance of Feynman-Kac \u2014 the theorem is far more general than just option pricing",
      "Confusing the forward Kolmogorov equation (evolves the distribution) with the backward equation (evolves the expected value, which is what Feynman-Kac uses)",
      "Forgetting the discounting term e^(\u2212\u222b r ds) in the Feynman-Kac representation \u2014 the PDE term \u2212r\u00b7u corresponds to this discounting",
    ],
    guideSection: "stoch-ito",
  },
  {
    id: "stoch-9",
    category: "stochastic-calculus",
    difficulty: "medium",
    duration: "quick",
    tags: ["martingale"],
    title: "Martingale Check",
    body: "Which is a martingale under the standard filtration?",
    choices: ["W(t)\u00b2", "W(t)\u00b2 \u2212 t", "e^(W(t))", "W(t)\u00b2 + t"],
    correctIndex: 1,
    explanation:
      "W(t)\u00b2 \u2212 t is a martingale. E[W(t)\u00b2|F_s] = W(s)\u00b2 + (t\u2212s), so subtracting t compensates.",
  },

  {
    id: "stoch-10",
    category: "stochastic-calculus",
    difficulty: "easy",
    duration: "quick",
    tags: ["ito-calculus"],
    askedAt: ["citadel", "sig"],
    title: "It\u00f4 Product Rule",
    body: "In stochastic calculus, d(XY) for two It\u00f4 processes equals:",
    choices: [
      "X dY + Y dX",
      "X dY + Y dX + dX dY",
      "X dY + Y dX - dX dY",
      "dX dY only",
    ],
    correctIndex: 1,
    explanation:
      "The It\u00f4 product rule includes the cross-variation term: d(XY) = X dY + Y dX + dX dY. The extra dX dY term is absent in ordinary calculus but non-zero in stochastic calculus because (dW)\u00b2 = dt.",
  },
  {
    id: "stoch-11",
    category: "stochastic-calculus",
    difficulty: "medium",
    duration: "medium",
    tags: ["mean-reversion", "derivation"],
    askedAt: ["jump-trading", "hudson-river"],
    title: "OU Process Mean",
    body: "For dX = \u03b8(\u03bc \u2212 X)dt + \u03c3dW with X(0) = x\u2080, what is E[X(t)]?",
    choices: [
      "\u03bc",
      "x\u2080 e^(-\u03b8t) + \u03bc(1 - e^(-\u03b8t))",
      "x\u2080 + \u03bct",
      "\u03bc(1 - e^(-\u03c3t))",
    ],
    correctIndex: 1,
    explanation:
      "Taking expectations: dE[X]/dt = \u03b8(\u03bc - E[X]). Solving: E[X(t)] = \u03bc + (x\u2080 - \u03bc)e^(-\u03b8t) = x\u2080 e^(-\u03b8t) + \u03bc(1 - e^(-\u03b8t)). Exponentially decays from x\u2080 toward \u03bc.",
  },
  {
    id: "stoch-12",
    category: "stochastic-calculus",
    difficulty: "hard",
    duration: "long",
    tags: ["martingale", "ito-calculus"],
    askedAt: ["jane-street", "de-shaw"],
    title: "Exponential Martingale",
    body: "For which value of c is M(t) = exp(W(t) - ct) a martingale?",
    choices: ["c = 0", "c = 1/2", "c = 1", "c = 2"],
    correctIndex: 1,
    explanation:
      "exp(W(t) - t/2) is the Dol\u00e9ans-Dade exponential martingale. Apply It\u00f4 to f(W,t) = exp(W - ct): the drift term vanishes when c = 1/2, giving dM = M dW (a local martingale).",
  },
  {
    id: "stoch-13",
    category: "stochastic-calculus",
    difficulty: "medium",
    duration: "medium",
    tags: ["ito-calculus", "derivation"],
    title: "GBM Solution",
    body: "The solution to dS = \u03bcS dt + \u03c3S dW with S(0) = S\u2080 is:",
    choices: [
      "S\u2080 exp(\u03bct + \u03c3W(t))",
      "S\u2080 exp((\u03bc - \u03c3\u00b2/2)t + \u03c3W(t))",
      "S\u2080(1 + \u03bct + \u03c3W(t))",
      "S\u2080 exp((\u03bc + \u03c3\u00b2/2)t + \u03c3W(t))",
    ],
    correctIndex: 1,
    explanation:
      "From It\u00f4's lemma, d(ln S) = (\u03bc - \u03c3\u00b2/2)dt + \u03c3dW. Integrating: ln(S(t)/S\u2080) = (\u03bc - \u03c3\u00b2/2)t + \u03c3W(t). So S(t) = S\u2080 exp((\u03bc - \u03c3\u00b2/2)t + \u03c3W(t)).",
  },
  {
    id: "stoch-14",
    category: "stochastic-calculus",
    difficulty: "hard",
    duration: "long",
    tags: ["martingale", "expected-value"],
    askedAt: ["jane-street"],
    title: "Stopping Time for BM",
    body: "For standard BM, let T_a = inf{t : W(t) = a} with a > 0. What is E[T_a]?",
    choices: ["a", "a\u00b2", "\u221e", "a/2"],
    correctIndex: 2,
    explanation:
      "E[T_a] = \u221e for standard BM hitting a one-sided barrier. While P(T_a < \u221e) = 1 (BM hits every level), the expected time is infinite because the distribution of T_a has a heavy tail (inverse Gaussian with infinite mean when drift = 0).",
  },
  {
    id: "stoch-15",
    category: "stochastic-calculus",
    difficulty: "easy",
    duration: "quick",
    tags: ["distributions"],
    askedAt: ["optiver"],
    title: "BM Scaling Property",
    body: "If W(t) is standard Brownian motion, then cW(t/c\u00b2) for c > 0 is:",
    choices: [
      "Not a Brownian motion",
      "A Brownian motion with drift c",
      "A standard Brownian motion",
      "A Brownian motion with variance c\u00b2",
    ],
    correctIndex: 2,
    explanation:
      "Brownian scaling: cW(t/c\u00b2) is again a standard BM. Check: starts at 0, continuous, Gaussian increments with mean 0 and variance c\u00b2 \u00d7 (t/c\u00b2) = t. All BM properties are preserved.",
  },
  {
    id: "stoch-16",
    category: "stochastic-calculus",
    difficulty: "medium",
    duration: "medium",
    tags: ["pde", "black-scholes"],
    askedAt: ["citadel", "two-sigma"],
    title: "Kolmogorov Backward Equation",
    body: "The backward Kolmogorov equation describes the evolution of:",
    choices: [
      "The probability density p(x, t)",
      "The expected value u(x,t) = E[f(X_T) | X_t = x]",
      "The volatility surface",
      "The forward rate curve",
    ],
    correctIndex: 1,
    explanation:
      "The backward equation governs u(x,t) = E[f(X_T) | X_t = x]: \u2202u/\u2202t + b(x)\u2202u/\u2202x + \u00bd\u03c3\u00b2(x)\u2202\u00b2u/\u2202x\u00b2 = 0. The FORWARD equation (Fokker-Planck) governs the density p(x,t).",
  },
  {
    id: "stoch-17",
    category: "stochastic-calculus",
    difficulty: "hard",
    duration: "long",
    tags: ["ito-calculus", "derivation"],
    askedAt: ["de-shaw"],
    title: "It\u00f4 Integral of W dW",
    body: "What is \u222b\u2080\u1d40 W(t) dW(t)?",
    choices: [
      "W(T)\u00b2/2",
      "(W(T)\u00b2 - T)/2",
      "(W(T)\u00b2 + T)/2",
      "T\u00b7W(T)/2",
    ],
    correctIndex: 1,
    explanation:
      "By It\u00f4's formula on f(x) = x\u00b2/2: d(W\u00b2/2) = W dW + (1/2)dt. Rearranging: \u222b W dW = W(T)\u00b2/2 - T/2 = (W(T)\u00b2 - T)/2. The -T/2 is the It\u00f4 correction (absent in ordinary calculus).",
  },

  // ═══════════════════════════════════════════════════════════════
  //  OPTIONS PRICING
  // ═══════════════════════════════════════════════════════════════
  {
    id: "opt-1",
    category: "options-pricing",
    difficulty: "easy",
    duration: "quick",
    tags: ["interview-classic", "hedging"],
    title: "Put-Call Parity",
    askedAt: ["optiver", "imc", "sig"],
    body: "Put-call parity for European options (no dividends):",
    choices: [
      "C \u2212 P = S \u2212 K",
      "C + P = S + Ke^(\u2212rT)",
      "C \u2212 P = S \u2212 Ke^(\u2212rT)",
      "C \u2212 P = Se^(\u2212rT) \u2212 K",
    ],
    correctIndex: 2,
    explanation:
      "C \u2212 P = S \u2212 Ke^(\u2212rT). Long call + short put replicates a forward.",
  },
  {
    id: "opt-2",
    category: "options-pricing",
    difficulty: "easy",
    duration: "quick",
    tags: ["interview-classic"],
    title: "Intrinsic Value",
    body: "European call: K=100, S=110. Intrinsic value?",
    choices: ["0", "10", "100", "110"],
    correctIndex: 1,
    explanation: "Call intrinsic = max(S \u2212 K, 0) = max(110 \u2212 100, 0) = 10.",
  },
  {
    id: "opt-3",
    category: "options-pricing",
    difficulty: "medium",
    duration: "quick",
    tags: ["greeks", "interview-classic"],
    title: "ATM Delta",
    askedAt: ["optiver", "sig", "citadel"],
    body: "Delta of an ATM European call is approximately:",
    choices: ["0", "0.25", "0.5", "1.0"],
    correctIndex: 2,
    explanation: "ATM call delta \u2248 0.5 \u2014 roughly 50/50 chance of finishing ITM.",
    detailedExplanation:
      "Step 1: In Black-Scholes, call delta = N(d\u2081) where d\u2081 = [ln(S/K) + (r + \u03c3\u00b2/2)T] / (\u03c3\u221aT). " +
      "Step 2: At-the-money means S = K, so ln(S/K) = 0. Then d\u2081 = (r + \u03c3\u00b2/2)T / (\u03c3\u221aT) = (r + \u03c3\u00b2/2)\u221aT/\u03c3. " +
      "Step 3: For short maturities or low rates, d\u2081 \u2248 0, so N(d\u2081) \u2248 N(0) = 0.5. In practice d\u2081 is slightly positive, so ATM delta is slightly above 0.5. " +
      "Step 4: Intuition \u2014 ATM means there is roughly a 50/50 chance the option finishes in-the-money. A $1 move in the underlying changes the option value by approximately $0.50. " +
      "This is also why delta-hedging an ATM option requires holding about half a share per option. As the option moves deep ITM, delta approaches 1; deep OTM, delta approaches 0.",
    commonMistakes: [
      "Thinking ATM delta is exactly 0.5 \u2014 it is slightly above 0.5 for calls (and slightly above \u22120.5 for puts) due to the lognormal drift term in d\u2081",
      "Confusing delta N(d\u2081) with the risk-neutral probability of finishing ITM N(d\u2082) \u2014 these differ by the factor e^(\u2212qT) and use different d values",
      "Forgetting that put delta = call delta \u2212 1, so an ATM put has delta \u2248 \u22120.5",
    ],
    guideSection: "opt-greeks",
  },
  {
    id: "opt-4",
    category: "options-pricing",
    difficulty: "medium",
    duration: "medium",
    tags: ["greeks", "volatility"],
    title: "Vega and Maturity",
    body: "How does ATM vega behave as time to expiry increases?",
    choices: ["Decreases", "Constant", "Increases", "First up then down"],
    correctIndex: 2,
    explanation: "ATM vega increases with time. More time = more vol exposure.",
  },
  {
    id: "opt-5",
    category: "options-pricing",
    difficulty: "hard",
    duration: "quick",
    tags: ["black-scholes", "interview-classic"],
    title: "BS Assumptions",
    body: "Which is NOT an assumption of Black-Scholes?",
    choices: [
      "Log-normal returns",
      "Constant volatility",
      "Constant risk-free rate",
      "Underlying can jump",
    ],
    correctIndex: 3,
    explanation:
      "BS assumes continuous paths (GBM). Jumps need extensions like Merton\u2019s jump-diffusion.",
    hint: "List the BS assumptions: continuous paths, constant vol, constant rates, log-normal returns. Which is NOT one?",
    resources: [
      { title: "Black-Scholes assumptions", url: "https://en.wikipedia.org/wiki/Black%E2%80%93Scholes_model#Assumptions", type: "article", free: true },
    ],
    detailedExplanation:
      "Step 1: The BS model assumes the underlying follows GBM: dS = \u03bcS dt + \u03c3S dW. GBM has continuous paths \u2014 the price cannot jump instantaneously. " +
      "Step 2: List all BS assumptions: (a) log-normal asset prices (continuous paths), (b) constant volatility \u03c3, (c) constant risk-free rate r, (d) no dividends (or known continuous dividend yield), (e) no transaction costs, (f) continuous trading possible, (g) no arbitrage. " +
      "Step 3: 'Underlying can jump' violates the continuous-path assumption. Real markets exhibit jumps (e.g., earnings announcements, crashes). This is why OTM options often trade at higher implied vol than BS predicts. " +
      "Step 4: Extensions that relax this assumption include Merton\u2019s jump-diffusion model (adds Poisson jumps to GBM), stochastic volatility models (Heston), and local volatility models (Dupire). " +
      "Knowing which assumptions are violated helps you understand when BS prices are unreliable and what corrections to apply.",
    commonMistakes: [
      "Thinking BS requires normally distributed prices \u2014 it requires log-normally distributed prices (i.e., log-returns are normal, not the prices themselves)",
      "Forgetting that BS assumes no transaction costs and continuous hedging \u2014 in practice, discrete hedging and transaction costs create hedging error",
      "Confusing constant volatility (a BS assumption) with constant drift (the drift \u03bc does not even appear in the BS formula, so its constancy is irrelevant)",
    ],
    guideSection: "opt-bs",
  },
  {
    id: "opt-6",
    category: "options-pricing",
    difficulty: "hard",
    duration: "medium",
    tags: ["greeks", "interview-classic"],
    title: "Maximum Gamma",
    body: "Where is gamma (\u2202\u00b2C/\u2202S\u00b2) highest?",
    choices: ["Deep ITM", "ATM near expiry", "Deep OTM", "ATM far from expiry"],
    correctIndex: 1,
    explanation: "Gamma peaks ATM near expiry \u2014 delta changes most rapidly there.",
  },
  {
    id: "opt-7",
    category: "options-pricing",
    difficulty: "easy",
    duration: "quick",
    tags: ["greeks"],
    title: "Theta Sign",
    body: "For a long vanilla option, theta is typically:",
    choices: ["Positive", "Negative", "Zero", "Depends on moneyness"],
    correctIndex: 1,
    explanation: "Long options decay over time. Theta is negative.",
  },
  {
    id: "opt-8",
    category: "options-pricing",
    difficulty: "medium",
    duration: "medium",
    tags: ["volatility", "interview-classic"],
    title: "Vol Smile",
    askedAt: ["optiver", "citadel", "imc"],
    body: "The equity vol smile means OTM puts have IV that is:",
    choices: ["Lower than ATM", "Equal to ATM", "Higher than ATM", "Undefined"],
    correctIndex: 2,
    explanation:
      "OTM puts have higher IV \u2014 the \u201cskew.\u201d Reflects crash risk and demand for protection.",
  },
  {
    id: "opt-9",
    category: "options-pricing",
    difficulty: "hard",
    duration: "long",
    tags: ["greeks", "hedging", "derivation"],
    title: "Delta-Gamma Hedging",
    body: "To delta-gamma hedge a portfolio, you need at minimum:",
    choices: [
      "1 instrument",
      "2: the underlying + 1 option",
      "3 instruments",
      "Infinite instruments",
    ],
    correctIndex: 1,
    explanation:
      "Underlying for delta (gamma=0), plus another option for gamma. Minimum 2.",
  },
  {
    id: "opt-10",
    category: "options-pricing",
    difficulty: "medium",
    duration: "quick",
    tags: ["greeks"],
    title: "What is Rho?",
    body: "The Greek \u2018rho\u2019 measures sensitivity to:",
    choices: ["Volatility", "Underlying price", "Interest rate", "Time"],
    correctIndex: 2,
    explanation: "Rho = \u2202C/\u2202r. Sensitivity to the risk-free rate.",
  },
  {
    id: "opt-11",
    category: "options-pricing",
    difficulty: "hard",
    duration: "long",
    tags: ["black-scholes", "pde", "derivation"],
    title: "Missing from BS PDE",
    askedAt: ["jane-street", "de-shaw"],
    body: "BS PDE: \u2202V/\u2202t + \u00bdS\u00b2\u03c3\u00b2\u2202\u00b2V/\u2202S\u00b2 + rS\u2202V/\u2202S \u2212 rV = 0. Which parameter is absent?",
    choices: ["\u03c3 (vol)", "\u03bc (drift)", "r (rate)", "S (price)"],
    correctIndex: 1,
    explanation:
      "The drift \u03bc disappears via hedging / risk-neutral pricing. You don\u2019t need expected returns to price options.",
    hint: "Compare the GBM parameters to what appears in the BS PDE. What's missing?",
    resources: [
      { title: "Black-Scholes PDE", url: "https://en.wikipedia.org/wiki/Black%E2%80%93Scholes_equation", type: "article", free: true },
    ],
    detailedExplanation:
      "Step 1: Start with GBM: dS = \u03bcS dt + \u03c3S dW. The stock has drift \u03bc. Form a riskless portfolio \u03a0 = V \u2212 \u0394S (long option, short \u0394 shares). " +
      "Step 2: By It\u00f4\u2019s lemma on V(S,t): dV = (\u2202V/\u2202t + \u03bcS\u2202V/\u2202S + \u00bd\u03c3\u00b2S\u00b2\u2202\u00b2V/\u2202S\u00b2)dt + \u03c3S\u2202V/\u2202S dW. " +
      "Step 3: Choose \u0394 = \u2202V/\u2202S to eliminate the dW term: d\u03a0 = (\u2202V/\u2202t + \u00bd\u03c3\u00b2S\u00b2\u2202\u00b2V/\u2202S\u00b2)dt. This portfolio is riskless! " +
      "Step 4: No-arbitrage: a riskless portfolio must earn r, so d\u03a0 = r\u03a0 dt. Substituting and rearranging gives the BS PDE with NO \u03bc anywhere. " +
      "Step 5: The drift \u03bc cancels because delta hedging eliminates directional exposure. Since you can hedge away the drift, the market does not reward you for bearing it in option pricing. This is the fundamental insight behind risk-neutral pricing.",
    commonMistakes: [
      "Thinking the drift \u03bc should matter for option pricing \u2014 the hedging argument eliminates it completely, which is why two investors with different views on \u03bc agree on the option price",
      "Not understanding the connection between hedging and risk-neutral pricing \u2014 the drift disappears precisely because the option can be perfectly replicated",
      "Confusing the risk-neutral drift r (which appears in the PDE) with the physical drift \u03bc (which does not) \u2014 under Q, all assets drift at r",
    ],
    guideSection: "opt-bs",
  },

  {
    id: "opt-12",
    category: "options-pricing",
    difficulty: "easy",
    duration: "quick",
    tags: ["interview-classic", "hedging"],
    askedAt: ["optiver", "imc"],
    title: "Butterfly Spread Payoff",
    body: "A long butterfly (buy 1 call K\u2081, sell 2 calls K\u2082, buy 1 call K\u2083, K\u2081<K\u2082<K\u2083) profits most when:",
    choices: [
      "Stock moves far from K\u2082",
      "Stock stays near K\u2082 at expiry",
      "Volatility increases",
      "Interest rates rise",
    ],
    correctIndex: 1,
    explanation:
      "A butterfly is a bet on low realized volatility around the center strike K\u2082. Max profit at S_T = K\u2082; loses if the stock moves significantly away.",
  },
  {
    id: "opt-13",
    category: "options-pricing",
    difficulty: "medium",
    duration: "medium",
    tags: ["volatility", "interview-classic"],
    askedAt: ["citadel", "optiver", "sig"],
    title: "Risk Reversal",
    body: "A risk reversal (long OTM call, short OTM put, same delta) is primarily a bet on:",
    choices: [
      "ATM volatility level",
      "Skew (difference between put and call IV)",
      "Time decay",
      "Interest rates",
    ],
    correctIndex: 1,
    explanation:
      "A risk reversal captures the skew: the difference in implied vol between OTM puts and OTM calls. If puts are expensive relative to calls (steep skew), the risk reversal is costly.",
  },
  {
    id: "opt-14",
    category: "options-pricing",
    difficulty: "hard",
    duration: "long",
    tags: ["greeks", "derivation"],
    askedAt: ["jane-street", "citadel"],
    title: "Gamma-Theta Tradeoff",
    body: "For a delta-neutral portfolio, the BS PDE simplifies to: \u0398 + \u00bd\u0393S\u00b2\u03c3\u00b2 = rV. If the portfolio is also cash-neutral (V\u22480), then:",
    choices: [
      "\u0398 = 0",
      "\u0398 \u2248 -\u00bd\u0393S\u00b2\u03c3\u00b2",
      "\u0398 = \u0393",
      "\u0398 = rV",
    ],
    correctIndex: 1,
    explanation:
      "With V \u2248 0 (cash-neutral) and delta = 0, the BS PDE gives \u0398 + \u00bd\u0393S\u00b2\u03c3\u00b2 \u2248 0, so \u0398 \u2248 -\u00bd\u0393S\u00b2\u03c3\u00b2. Positive gamma means negative theta: you pay time decay to collect gamma (realized vol) P&L.",
  },
  {
    id: "opt-15",
    category: "options-pricing",
    difficulty: "medium",
    duration: "quick",
    tags: ["greeks", "interview-classic"],
    askedAt: ["optiver", "imc", "sig"],
    title: "Vanna Definition",
    body: "The Greek 'vanna' measures:",
    choices: [
      "\u2202\u00b2V/\u2202S\u00b2 (gamma)",
      "\u2202\u00b2V/\u2202\u03c3\u00b2 (volga)",
      "\u2202\u00b2V/(\u2202S\u2202\u03c3) (delta sensitivity to vol)",
      "\u2202V/\u2202t (theta)",
    ],
    correctIndex: 2,
    explanation:
      "Vanna = \u2202\u0394/\u2202\u03c3 = \u2202vega/\u2202S. It measures how delta changes with vol or equivalently how vega changes with spot. Important for managing skew risk.",
  },
  {
    id: "opt-16",
    category: "options-pricing",
    difficulty: "easy",
    duration: "quick",
    tags: ["interview-classic"],
    title: "European vs American Call",
    body: "For a non-dividend-paying stock, an American call is worth:",
    choices: [
      "More than European call",
      "Less than European call",
      "Same as European call",
      "Depends on volatility",
    ],
    correctIndex: 2,
    explanation:
      "It is never optimal to early exercise an American call on a non-dividend-paying stock. The time value is always positive, so C_American = C_European.",
  },
  {
    id: "opt-17",
    category: "options-pricing",
    difficulty: "hard",
    duration: "long",
    tags: ["volatility", "derivation"],
    askedAt: ["citadel", "de-shaw"],
    title: "Local Vol vs Implied Vol",
    body: "Dupire's local volatility \u03c3_L(K,T) relates to the implied vol surface by:",
    choices: [
      "\u03c3_L = implied vol (they are the same)",
      "\u03c3_L depends on the slope and curvature of the implied vol surface",
      "\u03c3_L = realized vol",
      "\u03c3_L = ATM implied vol for all strikes",
    ],
    correctIndex: 1,
    explanation:
      "Dupire's formula extracts local vol from the implied vol surface: \u03c3\u00b2_L = (\u2202C/\u2202T + rK\u2202C/\u2202K) / (\u00bdK\u00b2\u2202\u00b2C/\u2202K\u00b2). It depends on the shape (slope and curvature) of call prices in K and T, not just the level.",
  },
  {
    id: "opt-18",
    category: "options-pricing",
    difficulty: "medium",
    duration: "medium",
    tags: ["hedging", "interview-classic"],
    askedAt: ["jump-trading", "optiver"],
    title: "Digital Option Delta",
    body: "As expiry approaches, the delta of an ATM binary (digital) call option:",
    choices: [
      "Approaches 0",
      "Approaches 0.5",
      "Approaches infinity",
      "Approaches 1",
    ],
    correctIndex: 2,
    explanation:
      "The digital call delta = N'(d\u2082)/(\u03c3S\u221aT). As T\u21920, if ATM, d\u2082\u21920, N'(0) = 1/\u221a(2\u03c0), and 1/(\u03c3S\u221aT) \u2192 \u221e. The delta spikes, making digital options extremely hard to hedge near expiry.",
  },
  {
    id: "opt-19",
    category: "options-pricing",
    difficulty: "hard",
    duration: "long",
    tags: ["volatility", "risk-management"],
    askedAt: ["citadel", "two-sigma"],
    title: "Variance Swap Replication",
    body: "A variance swap can be replicated by a portfolio of options. The weights are proportional to:",
    choices: [
      "1/K (inverse of strike)",
      "1/K\u00b2 (inverse square of strike)",
      "K (proportional to strike)",
      "Equal weight at all strikes",
    ],
    correctIndex: 1,
    explanation:
      "Variance swap replication requires a continuous strip of options weighted by 1/K\u00b2. OTM puts for K < F and OTM calls for K > F. The 1/K\u00b2 weighting comes from the log-contract replication formula: -2[ln(S_T/F) - (S_T/F - 1)] = 2\u222b dK/K\u00b2 \u00d7 max(K-S_T, 0) or max(S_T-K, 0).",
  },

  // ═══════════════════════════════════════════════════════════════
  //  BRAIN TEASERS
  // ═══════════════════════════════════════════════════════════════
  {
    id: "brain-1",
    category: "brain-teasers",
    difficulty: "easy",
    duration: "quick",
    tags: ["mental-math"],
    title: "Quick Percentage",
    body: "What is 15% of 80?",
    choices: ["10", "12", "15", "8"],
    correctIndex: 1,
    explanation: "10% of 80 = 8. 5% of 80 = 4. Total = 12.",
  },
  {
    id: "brain-2",
    category: "brain-teasers",
    difficulty: "medium",
    duration: "medium",
    tags: ["logic-puzzle", "interview-classic"],
    title: "Monty Hall",
    askedAt: ["jane-street", "optiver"],
    body: "You pick door 1. Host opens door 3 (goat). Should you switch?",
    choices: [
      "No \u2014 50/50",
      "Yes \u2014 switching gives 2/3",
      "Doesn\u2019t matter",
      "Yes \u2014 switching gives 3/4",
    ],
    correctIndex: 1,
    explanation:
      "Switching wins 2/3 of the time. Initial pick = 1/3. Host concentrates 2/3 on the other door.",
    detailedExplanation:
      "Step 1: When you first pick a door, P(car behind your door) = 1/3 and P(car behind one of the other two doors) = 2/3. " +
      "Step 2: The host, who KNOWS where the car is, opens a door with a goat. This is not random \u2014 the host always reveals a goat. This is the crucial asymmetry. " +
      "Step 3: Your door still has P = 1/3 (the host\u2019s action gives you no new information about your door). The entire 2/3 probability now concentrates on the single remaining unopened door. " +
      "Step 4: Therefore, switching gives P(win) = 2/3, while staying gives P(win) = 1/3. " +
      "Alternative reasoning: consider 100 doors. You pick one, the host opens 98 goat doors. Would you switch? Your door has 1% chance; the remaining door has 99%. The 3-door case is the same logic at a smaller scale.",
    commonMistakes: [
      "Assuming the host opening a door makes it 50/50 \u2014 this ignores that the host KNOWS where the car is and ALWAYS reveals a goat, which is an informative action",
      "Not recognizing that the host\u2019s action concentrates the 2/3 probability onto one door \u2014 the host cannot open your door or the car door, which constrains the problem",
      "Confusing conditional probability P(car|host opens door 3) with unconditional probability P(car) \u2014 the host\u2019s constrained choice updates the probabilities",
    ],
    guideSection: "brain-logic",
  },
  {
    id: "brain-3",
    category: "brain-teasers",
    difficulty: "medium",
    duration: "quick",
    tags: ["expected-value", "interview-classic"],
    title: "Dice Game EV",
    body: "Roll a fair die, get paid that many $. Cost to play: $3.50. Worth it?",
    choices: [
      "No, EV = $3.00",
      "No, EV = $3.50",
      "Yes, EV = $3.50",
      "Yes, EV = $4.00",
    ],
    correctIndex: 2,
    explanation: "E[die] = (1+2+3+4+5+6)/6 = 3.5. Exactly break-even.",
  },
  {
    id: "brain-4",
    category: "brain-teasers",
    difficulty: "hard",
    duration: "long",
    tags: ["logic-puzzle", "expected-value"],
    title: "Two Envelopes",
    body: "Two envelopes, one has 2x. You see $100. Naive switching EV = $125. The flaw?",
    choices: [
      "Probabilities aren\u2019t equal",
      "Conflates two sample spaces",
      "Can\u2019t open envelope",
      "EV is correct",
    ],
    correctIndex: 1,
    explanation:
      "The paradox conflates the scenario where $100 is the small amount vs the large amount without a proper prior.",
  },
  {
    id: "brain-5",
    category: "brain-teasers",
    difficulty: "hard",
    duration: "medium",
    tags: ["expected-value", "interview-classic"],
    title: "St. Petersburg Variant",
    body: "$1 start, double on heads, lose all on tails. E[payoff] after n flips?",
    choices: ["$1", "$2\u207f", "Diverges", "$0"],
    correctIndex: 0,
    explanation: "E = (1/2^n) \u00d7 2^n = $1. Growth exactly offsets probability decay.",
  },
  {
    id: "brain-6",
    category: "brain-teasers",
    difficulty: "easy",
    duration: "quick",
    tags: ["mental-math"],
    title: "Quick Multiply",
    body: "25 \u00d7 16 = ?",
    choices: ["350", "375", "400", "425"],
    correctIndex: 2,
    explanation: "25 \u00d7 16 = 25 \u00d7 4 \u00d7 4 = 100 \u00d7 4 = 400.",
  },
  {
    id: "brain-7",
    category: "brain-teasers",
    difficulty: "medium",
    duration: "medium",
    tags: ["estimation", "interview-classic"],
    title: "Fermi: Piano Tuners",
    body: "Roughly how many piano tuners in Chicago? (Pop ~2.7M)",
    choices: ["~20", "~100", "~200", "~1000"],
    correctIndex: 2,
    explanation:
      "~900K households, ~10% with pianos = 90K. Tuner does ~1000/year. 90K/1000 \u2248 90\u2013200.",
  },
  {
    id: "brain-8",
    category: "brain-teasers",
    difficulty: "easy",
    duration: "quick",
    tags: ["mental-math"],
    title: "Fraction to Decimal",
    body: "7/8 as a decimal?",
    choices: ["0.75", "0.825", "0.875", "0.9"],
    correctIndex: 2,
    explanation: "7/8 = 1 \u2212 1/8 = 1 \u2212 0.125 = 0.875.",
  },
  {
    id: "brain-9",
    category: "brain-teasers",
    difficulty: "hard",
    duration: "long",
    tags: ["logic-puzzle", "interview-classic"],
    title: "100 Prisoners & Lightbulb",
    askedAt: ["jane-street"],
    body: "100 prisoners, 1 lightbulb, random daily visits. One must declare \u201call visited.\u201d Optimal expected time?",
    choices: ["~1,000 days", "~2,500 days", "~10,000 days", "~50,000 days"],
    correctIndex: 2,
    explanation:
      "~10,000 days. One counter; others toggle on once. E \u2248 100 \u00d7 100 \u00d7 H\u2089\u2089.",
  },
  {
    id: "brain-10",
    category: "brain-teasers",
    difficulty: "medium",
    duration: "quick",
    tags: ["mental-math", "interview-classic"],
    title: "Mental Square Root",
    body: "Approximate \u221a50:",
    choices: ["~6.5", "~7.07", "~7.5", "~8.0"],
    correctIndex: 1,
    explanation: "\u221a49 = 7. \u221a50 = 5\u221a2 \u2248 5 \u00d7 1.414 = 7.07.",
  },
  {
    id: "brain-11",
    category: "brain-teasers",
    difficulty: "easy",
    duration: "quick",
    tags: ["mental-math"],
    title: "Compound Interest Shortcut",
    body: "At 6% annual interest, roughly how many years to double your money? (Rule of 72)",
    choices: ["6", "10", "12", "18"],
    correctIndex: 2,
    explanation: "Rule of 72: 72/6 = 12 years. Quick mental estimate for doubling time.",
  },

  {
    id: "brain-12",
    category: "brain-teasers",
    difficulty: "easy",
    duration: "quick",
    tags: ["logic-puzzle", "interview-classic"],
    askedAt: ["optiver", "imc"],
    title: "Clock Angle",
    body: "What is the angle between the hour and minute hands at 3:15?",
    choices: ["0\u00b0", "7.5\u00b0", "15\u00b0", "22.5\u00b0"],
    correctIndex: 1,
    explanation:
      "At 3:15, the minute hand points at 3 (90\u00b0). The hour hand has moved 15/60 \u00d7 30\u00b0 = 7.5\u00b0 past the 3, so it is at 97.5\u00b0. Angle = 7.5\u00b0.",
  },
  {
    id: "brain-13",
    category: "brain-teasers",
    difficulty: "medium",
    duration: "medium",
    tags: ["logic-puzzle", "interview-classic"],
    askedAt: ["jane-street", "sig"],
    title: "Handshake Problem",
    body: "10 people at a party each shake hands with every other person. How many handshakes total?",
    choices: ["90", "100", "45", "50"],
    correctIndex: 2,
    explanation:
      "C(10,2) = 10 \u00d7 9 / 2 = 45. Each handshake involves 2 people, so we divide by 2 to avoid double-counting.",
  },
  {
    id: "brain-14",
    category: "brain-teasers",
    difficulty: "hard",
    duration: "long",
    tags: ["logic-puzzle", "interview-classic"],
    askedAt: ["jane-street"],
    title: "12 Balls Weighing Puzzle",
    body: "You have 12 balls, one is different weight (heavier or lighter unknown). With a balance scale, minimum weighings to find the odd ball?",
    choices: ["2", "3", "4", "5"],
    correctIndex: 1,
    explanation:
      "3 weighings suffice. Each weighing has 3 outcomes (left heavy, balanced, right heavy), giving 3\u00b3 = 27 possible information outcomes. We need to identify 1 of 24 possibilities (12 balls \u00d7 2 heavy/light), and 27 \u2265 24. A careful ternary search strategy achieves this.",
  },
  {
    id: "brain-15",
    category: "brain-teasers",
    difficulty: "medium",
    duration: "medium",
    tags: ["expected-value", "interview-classic"],
    askedAt: ["optiver", "jump-trading"],
    title: "Ants on a Rod",
    body: "100 ants on a 1-meter rod at random positions, walking randomly left or right at 1 m/s. Ants meeting reverse direction. Time until all ants fall off?",
    choices: ["\u2264 0.5 sec", "\u2264 1 sec", "\u2264 2 sec", "Could be infinite"],
    correctIndex: 1,
    explanation:
      "Key insight: two ants meeting and reversing is equivalent to them passing through each other. So each ant independently walks in one direction. Maximum time = 1 second (ant starting at one end walking to the other).",
  },
  {
    id: "brain-16",
    category: "brain-teasers",
    difficulty: "easy",
    duration: "quick",
    tags: ["mental-math", "interview-classic"],
    askedAt: ["sig", "imc"],
    title: "Powers of 2",
    body: "2\u00b9\u2070 = 1024. What is 2\u00b2\u2070 approximately?",
    choices: ["~100,000", "~500,000", "~1,000,000", "~2,000,000"],
    correctIndex: 2,
    explanation:
      "2\u00b2\u2070 = (2\u00b9\u2070)\u00b2 = 1024\u00b2 = 1,048,576 \u2248 1 million. Useful mental shortcut: 2\u00b9\u2070 \u2248 10\u00b3.",
  },
  {
    id: "brain-17",
    category: "brain-teasers",
    difficulty: "hard",
    duration: "long",
    tags: ["logic-puzzle", "expected-value"],
    askedAt: ["jane-street", "two-sigma"],
    title: "Hat Puzzle: Majority Strategy",
    body: "3 people each get a random black or white hat. They simultaneously guess their own hat color or pass. They win if \u22651 correct guess and 0 wrong guesses. Best strategy success rate?",
    choices: ["50%", "75%", "87.5%", "100%"],
    correctIndex: 1,
    explanation:
      "Optimal strategy: if you see 2 same-colored hats, guess the opposite color; otherwise pass. This wins in 6/8 = 75% of cases. Fails only when all 3 hats are the same color (2/8 cases).",
  },
  {
    id: "brain-18",
    category: "brain-teasers",
    difficulty: "medium",
    duration: "quick",
    tags: ["estimation", "interview-classic"],
    askedAt: ["citadel"],
    title: "Quick ln(2)",
    body: "Approximate ln(2) to 2 decimal places:",
    choices: ["0.50", "0.63", "0.69", "0.72"],
    correctIndex: 2,
    explanation:
      "ln(2) \u2248 0.693. Useful to memorize. Related facts: ln(10) \u2248 2.303, e \u2248 2.718, 1/e \u2248 0.368.",
  },
  {
    id: "brain-19",
    category: "brain-teasers",
    difficulty: "hard",
    duration: "long",
    tags: ["expected-value", "interview-classic"],
    askedAt: ["jane-street", "hudson-river"],
    title: "Doubling Coin Flip Game",
    body: "You start with $1. Flip a fair coin repeatedly: heads doubles your money, tails ends the game and you keep what you have. What is E[payout]?",
    choices: ["$1", "$2", "$\u221e (diverges)", "$4"],
    correctIndex: 2,
    explanation:
      "After k heads (probability (1/2)^k), payout is $2^k. Tails on flip k+1 (probability 1/2) ends the game. E = \u2211_{k=0}^{\u221e} 2^k \u00d7 (1/2)^k \u00d7 (1/2) = (1/2) \u2211_{k=0}^{\u221e} 1 = \u221e. Each term contributes $0.50 and there are infinitely many terms. This is a variant of the St. Petersburg paradox.",
  },

  // ═══════════════════════════════════════════════════════════════
  //  LINEAR ALGEBRA
  // ═══════════════════════════════════════════════════════════════
  {
    id: "la-1",
    category: "linear-algebra",
    difficulty: "easy",
    duration: "quick",
    tags: ["matrix-ops"],
    title: "Eigenvalue of A\u00b2",
    body: "If \u03bb is an eigenvalue of A, then \u03bb\u00b2 is an eigenvalue of:",
    choices: ["A + A", "2A", "A\u00b2", "A\u1d40"],
    correctIndex: 2,
    explanation: "Av = \u03bbv \u21d2 A\u00b2v = \u03bb\u00b2v.",
  },
  {
    id: "la-2",
    category: "linear-algebra",
    difficulty: "easy",
    duration: "quick",
    tags: ["matrix-ops"],
    title: "Invertibility",
    body: "A square matrix is invertible iff its determinant is:",
    choices: ["Positive", "Negative", "Non-zero", "1"],
    correctIndex: 2,
    explanation: "det(A) \u2260 0 \u21d4 invertible.",
  },
  {
    id: "la-3",
    category: "linear-algebra",
    difficulty: "medium",
    duration: "medium",
    tags: ["matrix-ops", "portfolio-theory"],
    title: "Positive Definite",
    body: "A symmetric matrix is positive definite when:",
    choices: [
      "All diagonal entries > 0",
      "All eigenvalues > 0",
      "Trace > 0",
      "Determinant > 0",
    ],
    correctIndex: 1,
    explanation: "PD \u21d4 all eigenvalues > 0.",
  },
  {
    id: "la-4",
    category: "linear-algebra",
    difficulty: "medium",
    duration: "medium",
    tags: ["decomposition", "portfolio-theory"],
    title: "PCA First Component",
    askedAt: ["two-sigma", "de-shaw"],
    body: "PC1 is the eigenvector of the covariance matrix with the:",
    choices: ["Smallest eigenvalue", "Largest eigenvalue", "Median", "Closest to 1"],
    correctIndex: 1,
    explanation: "PC1 = direction of maximum variance = largest eigenvalue.",
  },
  {
    id: "la-5",
    category: "linear-algebra",
    difficulty: "hard",
    duration: "medium",
    tags: ["decomposition", "monte-carlo"],
    title: "Cholesky Decomposition",
    askedAt: ["two-sigma", "hudson-river"],
    body: "Cholesky A = LL\u1d40 requires A to be:",
    choices: [
      "Square and invertible",
      "Symmetric positive definite",
      "Orthogonal",
      "Diagonalizable",
    ],
    correctIndex: 1,
    explanation:
      "Cholesky needs symmetric PD. Used in finance for simulating correlated normals.",
    hint: "LL' only works for a specific class of matrices. Think about what makes a covariance matrix special.",
    detailedExplanation:
      "Step 1: Cholesky factorizes A = LL\u1d40 where L is lower triangular with positive diagonal entries. This is unique for symmetric positive definite (SPD) matrices. " +
      "Step 2: Why SPD? Symmetric ensures A = A\u1d40 so the decomposition is self-consistent. Positive definite ensures all eigenvalues > 0, which guarantees the square roots in L are real and positive. " +
      "Step 3: Finance application: to simulate n correlated normal random variables with covariance matrix \u03a3, compute L where \u03a3 = LL\u1d40. Then if Z ~ N(0, I), the vector X = LZ has Cov(X) = LE[ZZ\u1d40]L\u1d40 = LL\u1d40 = \u03a3. " +
      "Step 4: Cholesky is preferred over eigendecomposition for this purpose because it is about 2x faster (O(n\u00b3/3) vs O(n\u00b3)) and numerically stable. " +
      "Step 5: If \u03a3 is not positive definite (e.g., due to missing data or stale correlations), Cholesky will fail. In practice, you must first fix the matrix using nearest-PD projection or eigenvalue clipping.",
    commonMistakes: [
      "Trying to apply Cholesky to a non-positive-definite matrix \u2014 it will fail because square roots of negative eigenvalues are not real",
      "Confusing Cholesky (A = LL\u1d40, requires SPD) with LU decomposition (A = LU, works for any invertible matrix) \u2014 different requirements and use cases",
      "Not verifying that a covariance matrix is PD before applying Cholesky in Monte Carlo simulation \u2014 sample covariance matrices can be singular if n < p",
    ],
    guideSection: "la-decomposition",
  },
  {
    id: "la-6",
    category: "linear-algebra",
    difficulty: "easy",
    duration: "quick",
    tags: ["matrix-ops"],
    title: "Trace Property",
    body: "tr(A) equals the sum of its:",
    choices: ["Diagonal entries only", "Eigenvalues", "Singular values", "Both A and B"],
    correctIndex: 3,
    explanation: "tr(A) = \u2211a\u1d62\u1d62 = \u2211\u03bb\u1d62.",
  },
  {
    id: "la-7",
    category: "linear-algebra",
    difficulty: "medium",
    duration: "medium",
    tags: ["matrix-ops", "numerical-methods"],
    title: "Condition Number",
    body: "A large condition number means:",
    choices: [
      "Matrix is singular",
      "System is well-conditioned",
      "Small input changes \u2192 large output changes",
      "Complex eigenvalues",
    ],
    correctIndex: 2,
    explanation:
      "Large \u03ba = \u03bb_max/\u03bb_min means ill-conditioned \u2014 sensitive to perturbations.",
  },
  {
    id: "la-8",
    category: "linear-algebra",
    difficulty: "hard",
    duration: "long",
    tags: ["decomposition", "numerical-methods"],
    title: "SVD Uses",
    askedAt: ["de-shaw", "citadel"],
    body: "SVD (A = U\u03a3V\u1d40) is used for all EXCEPT:",
    choices: [
      "Dimensionality reduction",
      "Pseudo-inverse",
      "Sparse matrix storage",
      "Correlation matrix denoising",
    ],
    correctIndex: 2,
    explanation: "SVD handles dim reduction, pseudo-inverses, denoising. Sparse storage is unrelated (CSR/COO).",
    hint: "SVD produces dense U, \u03a3, V matrices. Does that help store a sparse matrix efficiently?",
    resources: [
      { title: "SVD and its applications (MIT)", url: "https://www.youtube.com/watch?v=rYz83XPxiZo", type: "video", free: true },
    ],
    detailedExplanation:
      "Step 1: SVD factorizes ANY m\u00d7n matrix A = U\u03a3V\u1d40, where U is m\u00d7m orthogonal, \u03a3 is m\u00d7n diagonal (singular values), V is n\u00d7n orthogonal. " +
      "Step 2: Dimensionality reduction (PCA): keep only the top k singular values/vectors. The truncated SVD gives the best rank-k approximation (Eckart-Young theorem). " +
      "Step 3: Pseudo-inverse: A\u207a = V\u03a3\u207aU\u1d40, where \u03a3\u207a inverts each non-zero singular value. This generalizes matrix inversion to non-square and singular matrices. " +
      "Step 4: Correlation matrix denoising (Marchenko-Pastur): keep only singular values above the random matrix theory threshold, setting the rest to zero. " +
      "Step 5: Sparse matrix storage is NOT an SVD application. SVD produces dense U, \u03a3, V matrices regardless of input sparsity. Sparse storage uses formats like CSR/COO that exploit zero patterns directly.",
    commonMistakes: [
      "Confusing SVD with eigendecomposition \u2014 SVD works for ANY matrix (rectangular, singular, etc.) while eigendecomposition requires a square matrix",
      "Thinking SVD produces a sparse representation \u2014 even if A is sparse, U, \u03a3, V are generally dense, making SVD useless for sparse storage",
      "Not knowing the Eckart-Young theorem \u2014 truncated SVD gives the BEST rank-k approximation in both Frobenius and spectral norms",
    ],
    guideSection: "la-decomposition",
  },
  {
    id: "la-9",
    category: "linear-algebra",
    difficulty: "hard",
    duration: "long",
    tags: ["matrix-ops", "risk-management"],
    title: "Spectral Theorem",
    body: "A real symmetric matrix decomposes as:",
    choices: ["LU", "QR", "Q\u039bQ\u1d40 (orthogonal Q)", "SVD only"],
    correctIndex: 2,
    explanation:
      "Spectral theorem: real symmetric \u21d2 A = Q\u039bQ\u1d40, Q orthogonal, \u039b diagonal with real eigenvalues.",
  },

  {
    id: "la-10",
    category: "linear-algebra",
    difficulty: "easy",
    duration: "quick",
    tags: ["matrix-ops"],
    askedAt: ["citadel"],
    title: "Rank-Nullity Theorem",
    body: "For an m\u00d7n matrix A, rank(A) + nullity(A) equals:",
    choices: ["m", "n", "m + n", "min(m, n)"],
    correctIndex: 1,
    explanation:
      "Rank-nullity theorem: rank(A) + nullity(A) = n (the number of columns). The rank is the dimension of the column space, nullity is the dimension of the null space.",
  },
  {
    id: "la-11",
    category: "linear-algebra",
    difficulty: "medium",
    duration: "medium",
    tags: ["matrix-ops"],
    askedAt: ["two-sigma", "de-shaw"],
    title: "Orthogonal Matrix Properties",
    body: "If Q is an orthogonal matrix, which is always true?",
    choices: [
      "det(Q) = 1",
      "Q\u1d40Q = I and all eigenvalues have ||\u03bb|| = 1",
      "All entries are 0 or 1",
      "Q is symmetric",
    ],
    correctIndex: 1,
    explanation:
      "Orthogonal: Q\u1d40Q = QQ\u1d40 = I. Eigenvalues satisfy |\u03bb| = 1 (they are \u00b11 for real orthogonal, or complex with unit modulus). det(Q) = \u00b11 (not necessarily +1; det = -1 for reflections).",
  },
  {
    id: "la-12",
    category: "linear-algebra",
    difficulty: "hard",
    duration: "long",
    tags: ["decomposition", "numerical-methods"],
    askedAt: ["hudson-river"],
    title: "QR Decomposition Use",
    body: "QR decomposition (A = QR) is primarily used in numerical linear algebra for:",
    choices: [
      "Sparse matrix storage",
      "Computing eigenvalues (QR algorithm) and solving least squares",
      "Matrix encryption",
      "Computing determinants only",
    ],
    correctIndex: 1,
    explanation:
      "QR decomposition is the backbone of the QR algorithm for computing eigenvalues and is used to solve least squares (Ax \u2248 b) more stably than the normal equations A\u1d40Ax = A\u1d40b.",
  },
  {
    id: "la-13",
    category: "linear-algebra",
    difficulty: "medium",
    duration: "medium",
    tags: ["matrix-ops", "portfolio-theory"],
    askedAt: ["two-sigma"],
    title: "Matrix Exponential Definition",
    body: "The matrix exponential e^A is defined as:",
    choices: [
      "Entry-wise exp of A",
      "\u2211 A^k / k! for k = 0, 1, 2, ...",
      "A \u00d7 e",
      "Only defined for diagonal matrices",
    ],
    correctIndex: 1,
    explanation:
      "e^A = I + A + A\u00b2/2! + A\u00b3/3! + ... = \u2211_{k=0}^{\u221e} A^k/k!. This series always converges. For diagonal D = diag(d_i), e^D = diag(e^{d_i}). Used in solving systems of ODEs and continuous-time Markov chains.",
  },
  {
    id: "la-14",
    category: "linear-algebra",
    difficulty: "easy",
    duration: "quick",
    tags: ["matrix-ops"],
    title: "Determinant Product Rule",
    body: "For n\u00d7n matrices A and B, det(AB) equals:",
    choices: ["det(A) + det(B)", "det(A) \u00d7 det(B)", "det(A+B)", "det(A)/det(B)"],
    correctIndex: 1,
    explanation:
      "det(AB) = det(A) \u00d7 det(B). This multiplicative property is fundamental. It also implies det(A\u207b\u00b9) = 1/det(A).",
  },
  {
    id: "la-15",
    category: "linear-algebra",
    difficulty: "hard",
    duration: "long",
    tags: ["decomposition", "risk-management"],
    askedAt: ["de-shaw", "citadel"],
    title: "Low-Rank Approximation",
    body: "The best rank-k approximation to a matrix A (in Frobenius norm) is given by:",
    choices: [
      "Truncated QR decomposition",
      "Truncated SVD (keep top k singular values)",
      "Random projection",
      "First k columns of A",
    ],
    correctIndex: 1,
    explanation:
      "The Eckart-Young theorem: the truncated SVD (keeping the k largest singular values) gives the best rank-k approximation in both Frobenius and spectral norms. The approximation error is \u03c3_{k+1}.",
  },
  {
    id: "la-16",
    category: "linear-algebra",
    difficulty: "medium",
    duration: "quick",
    tags: ["matrix-ops"],
    askedAt: ["jump-trading"],
    title: "Trace of Product",
    body: "For matrices A (m\u00d7n) and B (n\u00d7m), tr(AB) equals:",
    choices: ["tr(A) \u00d7 tr(B)", "tr(BA)", "tr(A + B)", "tr(A)tr(B) - tr(AB)"],
    correctIndex: 1,
    explanation:
      "The trace is cyclic: tr(AB) = tr(BA). More generally, tr(ABC) = tr(BCA) = tr(CAB). This holds even when the matrices have different dimensions, as long as the products are defined and square.",
  },
  {
    id: "la-17",
    category: "linear-algebra",
    difficulty: "hard",
    duration: "medium",
    tags: ["matrix-ops", "numerical-methods"],
    askedAt: ["two-sigma", "hudson-river"],
    title: "Sherman-Morrison Formula",
    body: "The Sherman-Morrison formula efficiently computes the inverse of A + uv\u1d40 given A\u207b\u00b9. Its complexity is:",
    choices: ["O(n\u00b3)", "O(n\u00b2)", "O(n)", "O(n\u00b2 log n)"],
    correctIndex: 1,
    explanation:
      "(A + uv\u1d40)\u207b\u00b9 = A\u207b\u00b9 - (A\u207b\u00b9 u v\u1d40 A\u207b\u00b9)/(1 + v\u1d40 A\u207b\u00b9 u). Given A\u207b\u00b9, this requires only matrix-vector products: O(n\u00b2) instead of O(n\u00b3) for a full inversion. Essential for online/streaming updates in finance.",
  },

  // ═══════════════════════════════════════════════════════════════
  //  CROSS-CATEGORY / ADVANCED
  // ═══════════════════════════════════════════════════════════════
  {
    id: "adv-1",
    category: "options-pricing",
    difficulty: "hard",
    duration: "long",
    tags: ["monte-carlo", "numerical-methods"],
    title: "MC Convergence Rate",
    body: "MC error decreases O(1/\u221aN). To halve the error you need:",
    choices: ["2x samples", "4x samples", "10x samples", "\u221a2x samples"],
    correctIndex: 1,
    explanation: "1/\u221a(4N) = \u00bd/\u221aN. Need 4x samples to halve error.",
    hint: "If error \u221d 1/\u221aN, what must happen to N to halve the error?",
    resources: [
      { title: "Monte Carlo methods in finance", url: "https://en.wikipedia.org/wiki/Monte_Carlo_methods_in_finance", type: "article", free: true },
    ],
    detailedExplanation:
      "Step 1: The Monte Carlo estimator for E[X] is X\u0304 = (1/N)\u03a3X\u1d62. By CLT, X\u0304 is approximately normal with standard error SE = \u03c3/\u221aN. " +
      "Step 2: We want to halve the error: SE_new = SE/2, so \u03c3/\u221a(N_new) = \u03c3/(2\u221aN). " +
      "Step 3: Solving: \u221a(N_new) = 2\u221aN, so N_new = 4N. You need 4 times as many samples to halve the error. " +
      "Step 4: This O(1/\u221aN) convergence is slow. Going from 2 decimal places to 3 requires 100x more samples. This is why variance reduction techniques (antithetic variates, control variates, importance sampling) are essential in practice. " +
      "Key insight: the convergence rate is dimension-independent, which is why MC beats grid methods in high dimensions (where grid methods scale as O(1/N^(1/d))).",
    commonMistakes: [
      "Thinking doubling the samples halves the error \u2014 doubling only reduces error by factor \u221a2 \u2248 1.41, not by half",
      "Confusing the convergence rate O(1/\u221aN) with bias \u2014 MC is unbiased; the 1/\u221aN rate describes the standard error (precision), not accuracy",
      "Not considering variance reduction techniques that can dramatically improve the effective convergence rate beyond the basic 1/\u221aN",
    ],
    guideSection: "la-numerical",
  },
  {
    id: "adv-2",
    category: "probability",
    difficulty: "medium",
    duration: "medium",
    tags: ["expected-value", "interview-classic"],
    title: "Dice Reroll Strategy",
    askedAt: ["jane-street", "optiver", "sig"],
    body: "Roll a fair die, can keep or reroll once. Optimal EV?",
    choices: ["3.5", "4.25", "4.5", "5.0"],
    correctIndex: 1,
    explanation:
      "Reroll if \u22643 (EV=3.5 > current). Keep 4,5,6. EV = (3/6)(3.5) + (1/6)(4+5+6) = 4.25.",
    detailedExplanation:
      "Step 1: This is an optimal stopping problem. After the first roll, you see a value v and must decide: keep v, or reroll (getting E[die] = 3.5 on the reroll). " +
      "Step 2: Optimal strategy: keep v if v > 3.5, reroll if v \u2264 3.5. Since die outcomes are integers, keep {4, 5, 6} and reroll {1, 2, 3}. " +
      "Step 3: Compute EV. P(keep) = 3/6 with E[value | keep] = (4+5+6)/3 = 5. P(reroll) = 3/6 with E[value | reroll] = 3.5. " +
      "Step 4: EV = (3/6)(5) + (3/6)(3.5) = 2.5 + 1.75 = 4.25. " +
      "Key insight: the threshold is the expected value of the next roll. You should reroll whenever your current value is below the expected value of a fresh roll. This generalizes to multi-round stopping problems.",
    commonMistakes: [
      "Rerolling on a 4 \u2014 since E[reroll] = 3.5 < 4, keeping a 4 is strictly better than rerolling",
      "Not recognizing the threshold structure \u2014 the optimal strategy is always 'keep if above threshold, reroll if below'",
      "Computing E[always reroll] = 3.5 instead of the conditional EV that accounts for the keep/reroll decision",
    ],
    guideSection: "brain-ev-games",
  },
  {
    id: "adv-3",
    category: "statistics",
    difficulty: "medium",
    duration: "medium",
    tags: ["risk-management", "portfolio-theory"],
    title: "VaR Shortcoming",
    body: "A well-known flaw of Value-at-Risk is:",
    choices: [
      "Hard to compute",
      "Not sub-additive (fails diversification)",
      "Requires normality",
      "Can\u2019t be backtested",
    ],
    correctIndex: 1,
    explanation:
      "VaR can violate sub-additivity: VaR(A+B) > VaR(A)+VaR(B). CVaR fixes this.",
  },
  {
    id: "adv-4",
    category: "options-pricing",
    difficulty: "medium",
    duration: "quick",
    tags: ["volatility", "interview-classic"],
    title: "Straddle P&L",
    body: "You buy an ATM straddle. You profit when:",
    choices: [
      "Stock rises",
      "Stock falls",
      "Realized vol > implied vol",
      "Implied vol drops",
    ],
    correctIndex: 2,
    explanation: "Straddles bet on vol. Profit when realized moves > implied pricing.",
    hint: "A straddle is long call + long put ATM. What drives its P&L?",
  },
  {
    id: "adv-5",
    category: "probability",
    difficulty: "hard",
    duration: "long",
    tags: ["expected-value", "interview-classic"],
    title: "Broken Stick",
    askedAt: ["jane-street", "two-sigma"],
    body: "Break a unit stick at 2 random points. P(three pieces form a triangle)?",
    choices: ["1/2", "1/3", "1/4", "1/8"],
    correctIndex: 2,
    explanation:
      "P = 1/4. Triangle inequality requires all pieces < 1/2. The favorable simplex region has area 1/4.",
    hint: "Triangle inequality: each piece must be < sum of the other two. For a unit stick, this means each piece < 1/2.",
    detailedExplanation:
      "Step 1: Break the unit stick at two random uniform points U\u2081, U\u2082 on [0,1]. Let the three pieces have lengths X, Y, Z where X + Y + Z = 1. " +
      "Step 2: Triangle inequality requires: X < Y + Z, Y < X + Z, Z < X + Y. Since X + Y + Z = 1, these simplify to X < 1/2, Y < 1/2, Z < 1/2. " +
      "Step 3: Geometrically, the sample space of (X, Y) with X \u2265 0, Y \u2265 0, X + Y \u2264 1 is a simplex (triangle) with area 1/2. " +
      "Step 4: The favorable region where X < 1/2, Y < 1/2, and Z = 1 \u2212 X \u2212 Y > 1/2 (equivalently X + Y < 1/2) is a smaller triangle with area 1/8. Wait \u2014 actually the favorable region is where ALL three constraints hold: X < 1/2, Y < 1/2, X + Y > 1/2. This is the central triangle with area 1/8. " +
      "Step 5: P = (favorable area)/(total area) = (1/8)/(1/2) = 1/4. The probability is exactly 1/4.",
    commonMistakes: [
      "Forgetting one of the three triangle inequality constraints \u2014 all three pieces must be less than 1/2, not just one or two",
      "Not recognizing the geometric probability approach \u2014 the problem maps to areas in a 2D simplex, making visualization essential",
      "Confusing this with breaking at one point instead of two \u2014 breaking at one point gives two pieces which always fail the triangle inequality (you need three pieces)",
    ],
    guideSection: "prob-counting",
  },
  {
    id: "adv-6",
    category: "statistics",
    difficulty: "hard",
    duration: "long",
    tags: ["portfolio-theory", "risk-management"],
    title: "Capital Market Line",
    body: "On the efficient frontier, adding a risk-free asset creates the:",
    choices: ["Security Market Line", "Capital Market Line", "Capital Allocation Line", "Characteristic Line"],
    correctIndex: 1,
    explanation:
      "The tangent from r_f to the frontier is the CML. All optimal portfolios lie on it.",
  },
  {
    id: "adv-7",
    category: "stochastic-calculus",
    difficulty: "hard",
    duration: "long",
    tags: ["pde", "numerical-methods"],
    title: "Explicit FD Stability",
    body: "The main drawback of explicit finite differences for BS PDE:",
    choices: [
      "Inaccurate",
      "Unstable for large \u0394t",
      "Requires matrix inversion",
      "European options only",
    ],
    correctIndex: 1,
    explanation:
      "Explicit FD is conditionally stable: needs \u0394t \u2264 \u0394x\u00b2/(2D). Implicit is unconditionally stable.",
    hint: "Think about the CFL condition for explicit schemes.",
    resources: [
      { title: "Finite Difference Methods for Option Pricing", url: "https://en.wikipedia.org/wiki/Finite_difference_methods_for_option_pricing", type: "article", free: true },
    ],
  },
  {
    id: "adv-8",
    category: "options-pricing",
    difficulty: "medium",
    duration: "medium",
    tags: ["volatility", "risk-management"],
    title: "Variance Swap Strike",
    body: "A variance swap\u2019s fair strike equals:",
    choices: ["Historical variance", "ATM IV", "Risk-neutral E[realized var]", "The VIX"],
    correctIndex: 2,
    explanation:
      "Fair strike = E^Q[realized var]. Replicated by a strip of options across all strikes.",
  },
  {
    id: "adv-9",
    category: "probability",
    difficulty: "easy",
    duration: "quick",
    tags: ["expected-value", "interview-classic"],
    title: "Linearity of Expectation",
    body: "100 people check coats. Coats returned randomly. E[people who get their own coat]?",
    choices: ["0", "1", "10", "50"],
    correctIndex: 1,
    explanation:
      "E = \u2211P(person i gets own coat) = 100 \u00d7 1/100 = 1. Linearity of expectation \u2014 no independence needed.",
  },
  {
    id: "adv-10",
    category: "options-pricing",
    difficulty: "easy",
    duration: "quick",
    tags: ["interview-classic", "hedging"],
    title: "Protective Put",
    body: "Long stock + long put is equivalent to:",
    choices: [
      "Short straddle",
      "Long call + bond",
      "Short strangle",
      "Bear spread",
    ],
    correctIndex: 1,
    explanation:
      "By put-call parity: S + P = C + Ke^(\u2212rT). Stock + put = call + bond.",
  },
];
